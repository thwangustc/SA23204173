<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Tianhao Wang" />


<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Tianhao Wang</h4>
<h4 class="date">2023-12-8</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">library</span>(stats)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">library</span>(boot) </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">library</span>(bootstrap)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="fu">library</span>(DAAG)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="fu">library</span>(coda)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="fu">library</span>(microbenchmark)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="fu">library</span>(Rcpp)</span></code></pre></div>
<div id="homework-0" class="section level2">
<h2>homework 0</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer-0" class="section level2">
<h2>answer 0</h2>
<div id="example-0.1" class="section level3">
<h3>example 0.1</h3>
<p>Trend filtering models are typical methods for processing
one-dimensional time series data and spatially heterogeneous data. They
are widely used in astronomy and astro-spectroscopy, medicine, and
epidemiology. HP filtering, in particular, is extensively applied in
macroeconomics. The development of trend filtering methods started from
HP filtering and has since evolved into <span class="math inline">\(\ell_1\)</span> and <span class="math inline">\(\ell_0\)</span> filtering models.</p>
<p>The HP filter, proposed by Hodrick &amp; Prescott, is a common
business cycle modeling method in economics. It can be formulated as the
following regularized least squares problem:</p>
<p><span class="math display">\[
\min _{\boldsymbol{\alpha} \in \mathbb{R}^n } \frac{1}{2}
\sum_{i=1}^n\left(y_i-\alpha_i\right)^2+\lambda
\sum_{i=2}^{n-1}\left(\alpha_{i-1}-2 \alpha_i+\alpha_{i+1}\right)^2.
\]</span></p>
<p>To simplify the above expression, Tibshirani defined the difference
matrix as:</p>
<p><span class="math display">\[
D^{(1)}=D_{(n-1) \times n}=\left[\begin{array}{ccccc}
            -1 &amp; 1 &amp; &amp; &amp; \\
            &amp; -1 &amp; 1 &amp; &amp; \\
            &amp; &amp; \ddots &amp; \ddots &amp; \\
            &amp; &amp; &amp; -1 &amp; 1
    \end{array}\right].
\]</span></p>
<p>The above matrix is a first-order difference matrix, related to the
sample size <span class="math inline">\(n\)</span>. The <span class="math inline">\(q+1\)</span> order difference matrix is defined
as:</p>
<p><span class="math display">\[
    D^{(q+1)}=\prod_{l=1}^{q+1} D_{(n-l) \times(n-l+1)} \in R^{(n-q-1)
\times n}, \quad q=1,2, \ldots.
\]</span></p>
<p>Using a second-order difference matrix representation, the
regularized least squares problem corresponding to HP filtering can be
rewritten in the following vector form:</p>
<p><span class="math display">\[
\min _{\boldsymbol{\alpha}}
\frac{1}{2}\|\boldsymbol{y}-\boldsymbol{\alpha}\|_2^2+\lambda\left\|\boldsymbol{D}^{(2)}
\boldsymbol{\alpha}\right\|_{\ell_2}^2.
\]</span></p>
</div>
<div id="example-0.2" class="section level3">
<h3>example 0.2</h3>
<p>We consider generating Doppler data (the trend term denoted as <span class="math inline">\(\alpha_t\)</span>), taking the noise from the
standard normal distribution (noise term denoted as <span class="math inline">\(\epsilon_t\)</span>) multiplied by a constant. The
actual data <span class="math inline">\({y_t}\)</span> in the simulation
setup is generated as follows:</p>
<p><span class="math display">\[y_t=\alpha_t+0.1\epsilon_t,\quad
t=1,2,\dots,n.\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>SimuDoppler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">sigma =</span> <span class="fl">0.1</span>, <span class="at">seed=</span><span class="cn">NA</span>){</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(seed)) <span class="fu">set.seed</span>(seed)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">/</span>n, <span class="dv">1</span>,<span class="at">length.out =</span> n)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  y0 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x))<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="fl">+0.05</span>)<span class="sc">/</span>(x<span class="fl">+0.05</span>))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y0 <span class="sc">+</span> sigma<span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="co">#y &lt;- y0 + sigma*rt(n, 4)</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">y =</span> y, <span class="at">y0 =</span> y0, <span class="at">x=</span>x))</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  Doppler <span class="ot">&lt;-</span> <span class="fu">SimuDoppler</span>(n,<span class="at">sigma=</span><span class="fl">0.1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Doppler<span class="sc">$</span>x,Doppler<span class="sc">$</span>y)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="fu">rownames</span>(data) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  data[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>##        X            Y
## 1  0.001  0.005573820
## 2  0.002 -0.089198974
## 3  0.003 -0.001539657
## 4  0.004  0.259302100
## 5  0.005  0.046838104
## 6  0.006  0.084621523
## 7  0.007 -0.091250036
## 8  0.008  0.165736552
## 9  0.009 -0.176913004
## 10 0.010  0.007871654</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.001</td>
<td align="right">0.0055738</td>
</tr>
<tr class="even">
<td align="right">0.002</td>
<td align="right">-0.0891990</td>
</tr>
<tr class="odd">
<td align="right">0.003</td>
<td align="right">-0.0015397</td>
</tr>
<tr class="even">
<td align="right">0.004</td>
<td align="right">0.2593021</td>
</tr>
<tr class="odd">
<td align="right">0.005</td>
<td align="right">0.0468381</td>
</tr>
<tr class="even">
<td align="right">0.006</td>
<td align="right">0.0846215</td>
</tr>
<tr class="odd">
<td align="right">0.007</td>
<td align="right">-0.0912500</td>
</tr>
<tr class="even">
<td align="right">0.008</td>
<td align="right">0.1657366</td>
</tr>
<tr class="odd">
<td align="right">0.009</td>
<td align="right">-0.1769130</td>
</tr>
<tr class="even">
<td align="right">0.010</td>
<td align="right">0.0078717</td>
</tr>
</tbody>
</table>
<p>SimuDoppler is a function for generating data sets. We output the
first 10 elements of the data set in two ways: direct output and output
using the kable function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>  data[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code></pre></div>
<pre><code>##        X            Y
## 1  0.001  0.005573820
## 2  0.002 -0.089198974
## 3  0.003 -0.001539657
## 4  0.004  0.259302100
## 5  0.005  0.046838104
## 6  0.006  0.084621523
## 7  0.007 -0.091250036
## 8  0.008  0.165736552
## 9  0.009 -0.176913004
## 10 0.010  0.007871654</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(data[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.001</td>
<td align="right">0.0055738</td>
</tr>
<tr class="even">
<td align="right">0.002</td>
<td align="right">-0.0891990</td>
</tr>
<tr class="odd">
<td align="right">0.003</td>
<td align="right">-0.0015397</td>
</tr>
<tr class="even">
<td align="right">0.004</td>
<td align="right">0.2593021</td>
</tr>
<tr class="odd">
<td align="right">0.005</td>
<td align="right">0.0468381</td>
</tr>
<tr class="even">
<td align="right">0.006</td>
<td align="right">0.0846215</td>
</tr>
<tr class="odd">
<td align="right">0.007</td>
<td align="right">-0.0912500</td>
</tr>
<tr class="even">
<td align="right">0.008</td>
<td align="right">0.1657366</td>
</tr>
<tr class="odd">
<td align="right">0.009</td>
<td align="right">-0.1769130</td>
</tr>
<tr class="even">
<td align="right">0.010</td>
<td align="right">0.0078717</td>
</tr>
</tbody>
</table>
<p>The scatter plot of the relationship between dataset “X” and “Y” is
as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>  <span class="fu">plot</span>(Doppler<span class="sc">$</span>x,Doppler<span class="sc">$</span>y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-1" class="section level2">
<h2>homework 1</h2>
<div id="homework-1.1" class="section level3">
<h3>homework 1.1</h3>
<p>Replicate a part of the function sample using the inverse
transformation method (with replace=TRUE).</p>
</div>
<div id="answer-1.1" class="section level3">
<h3>answer 1.1</h3>
<p>The my_sample function is used to implement sampling with
replacement, featuring three parameters: <span class="math inline">\(x\)</span>: the population for sampling. If <span class="math inline">\(x\)</span> is a positive integer, it represents
the sampling population <span class="math inline">\({1,2,3,\dots,x}\)</span>; <span class="math inline">\(size\)</span>: the number of samples; <span class="math inline">\(prob\)</span>: whether it is equal probability
sampling. By default, it is equal probability sampling. If it is unequal
probability sampling, please input a sampling probability distribution
of the same length as <span class="math inline">\(x\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>  my_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x,size,<span class="at">prob=</span><span class="cn">NULL</span>){</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">==</span><span class="dv">1</span>) x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>x</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.null</span>(prob)) prob <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>n,n)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    cp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    m <span class="ot">&lt;-</span> size</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    <span class="fu">return</span>(r)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  size <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_sample</span>(x,size)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,size,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,size),<span class="fu">rep</span>(<span class="dv">1</span>,size)),<span class="fu">c</span>(X, Y))</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="fu">barplot</span>(counts, <span class="at">main=</span><span class="st">&quot;Sampling distribution generation eg1&quot;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&#39;Count&#39;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Inverse&#39;</span>,<span class="st">&#39;Sample&#39;</span>), <span class="at">beside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">81</span><span class="sc">:</span><span class="dv">85</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  size <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_sample</span>(x,size)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,size,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,size),<span class="fu">rep</span>(<span class="dv">1</span>,size)),<span class="fu">c</span>(X, Y))</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="fu">barplot</span>(counts, <span class="at">main=</span><span class="st">&quot;Sampling distribution generation eg2&quot;</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&#39;Count&#39;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Inverse&#39;</span>,<span class="st">&#39;Sample&#39;</span>), <span class="at">beside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">89</span>,<span class="dv">98</span>,<span class="dv">100</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  size <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_sample</span>(x,size)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,size,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,size),<span class="fu">rep</span>(<span class="dv">1</span>,size)),<span class="fu">c</span>(X, Y))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">barplot</span>(counts, <span class="at">main=</span><span class="st">&quot;Sampling distribution generation eg3&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&#39;Count&#39;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Inverse&#39;</span>,<span class="st">&#39;Sample&#39;</span>), <span class="at">beside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;man&quot;</span>,<span class="st">&quot;woman&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  size <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_sample</span>(x,size,<span class="at">prob=</span>prob)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,size,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span>prob)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,size),<span class="fu">rep</span>(<span class="dv">1</span>,size)),<span class="fu">c</span>(X, Y))</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">barplot</span>(counts, <span class="at">main=</span><span class="st">&quot;Sampling distribution generation eg4&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&#39;Count&#39;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Inverse&#39;</span>,<span class="st">&#39;Sample&#39;</span>), <span class="at">beside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">89</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">101</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  size <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_sample</span>(x,size,<span class="at">prob=</span>prob)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,size,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span>prob)</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,size),<span class="fu">rep</span>(<span class="dv">1</span>,size)),<span class="fu">c</span>(X, Y))</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">barplot</span>(counts, <span class="at">main=</span><span class="st">&quot;Sampling distribution generation eg5&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&#39;Count&#39;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Inverse&#39;</span>,<span class="st">&#39;Sample&#39;</span>), <span class="at">beside=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Regardless of the population <span class="math inline">\(x\)</span>,
we always consider the index set of the population as a positive integer
set <span class="math inline">\({1,2,3,\dots,length(x)}\)</span>. We
consider five scenarios here, the first three are equal probability
sampling, and the last two are unequal probability sampling. We have
verified that under large sample conditions, the sampling distribution
obtained by the sample function and the my_sample function are
essentially consistent, replicating part of the functionality of the
sample function (with replace=TRUE).</p>
</div>
<div id="homework-1.2" class="section level3">
<h3>homework 1.2</h3>
<p>The standard Laplace distribution has the density <span class="math inline">\(f(x)=\frac{1}{2} e^{-|x|}, x \in
\mathbb{R}\)</span>. Use the inverse transform method to generate a
random sample of size 1000 from this distribution. Use one of the
methods shown in this chapter to compare the generated sample to the
target distribution.</p>
</div>
<div id="answer-1.2" class="section level3">
<h3>answer 1.2</h3>
<p>By integrating the density function for <span class="math inline">\(x&gt;0\)</span> and <span class="math inline">\(x&lt;0\)</span>, the distribution function of the
standard Laplace can be obtained: <span class="math display">\[
F(x)=
\left\{
    \begin{array}{lc}
        \frac{1}{2}e^x, \quad,x \leq 0,\\
        1-\frac{1}{2}e^{-x}, \quad x&gt;0.\\
    \end{array}
\right.
\]</span></p>
<p>Using the inverse transform method, where <span class="math inline">\(F(x)=u\)</span> and <span class="math inline">\(u\)</span> is generated from the uniform
distribution <span class="math inline">\(U(0,1)\)</span>. Due to the
piecewise nature of the probability density function and the value of
the distribution function at <span class="math inline">\(x=0\)</span>,
when <span class="math inline">\(u\leq \frac{1}{2}\)</span>, we take
<span class="math inline">\(u=\frac{1}{2}e^x\)</span>, which gives <span class="math inline">\(x=\ln(2u)\)</span>; when <span class="math inline">\(u &gt; \frac{1}{2}\)</span>, we take <span class="math inline">\(u=1-\frac{1}{2}e^{-x}\)</span>, which gives <span class="math inline">\(x=-\ln(2-2u)\)</span>. The following my_Laplace
function generates the standard Laplace distribution.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>  my_Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>x),<span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>x))</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    <span class="fu">return</span>(r)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  }</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  </span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">my_Laplace</span>(<span class="dv">1000</span>)</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(mydata, <span class="fu">aes</span>(<span class="at">x =</span> x))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)))<span class="sc">+</span><span class="fu">geom_density</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The above is the histogram of density and the fitted probability
density curve for 1000 samples generated by the my_Laplace function.
Next, we will discuss the difference between the distribution generated
by the my_Laplace function and the actual probability distribution under
larger sample sizes.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="at">length=</span>n)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  y0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="fu">ifelse</span>(x<span class="sc">&gt;</span><span class="dv">0</span>,<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x),<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(x))</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  }</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">my_Laplace</span>(n)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y1)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>y1))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">30</span>)<span class="sc">+</span><span class="fu">geom_density</span>(<span class="at">color=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun=</span>y0)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="at">length=</span>n)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">my_Laplace</span>(n)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y1)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>y1))<span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">30</span>)<span class="sc">+</span><span class="fu">geom_density</span>(<span class="at">color=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun=</span>y0)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We consider two large sample situations of 10000 and 100000. In the
above two plots, the red curve is the fitted curve generated by
my_Laplace, and the black curve is the actual density function curve. We
find that the two curves almost coincide, so we can consider that the
my_Laplace function has generated the standard Laplace distribution.</p>
</div>
<div id="homework-1.3" class="section level3">
<h3>homework 1.3</h3>
<p>Write a function to generate a random sample of size <span class="math inline">\(\mathrm{n}\)</span> from the <span class="math inline">\(Beta(a, b)\)</span> distribution using the
acceptance-rejection method. Generate a random sample of size 1000 from
the <span class="math inline">\(Beta(3,2)\)</span> distribution and
graph the histogram of the sample with the theoretical Beta <span class="math inline">\((3,2)\)</span> density superimposed.</p>
</div>
<div id="answer-1.3" class="section level3">
<h3>answer 1.3</h3>
<p>Calculating <span class="math inline">\(Beta(3,2)=\frac{1}{12}\)</span>, we obtain the
density function of the Beta distribution <span class="math inline">\(f(x; 3,2)=12 x^2(1-x)= 48(\frac{x}{2})^2(1-x) \leq
48(\frac{1-x+\frac{x}{2}+\frac{x}{2}}{3})^3=\frac{16}{9}\)</span>. Next,
we use the acceptance-rejection algorithm to generate the Beta
distribution. Based on the inequality mentioned, we set <span class="math inline">\(g(x)=1\)</span> for <span class="math inline">\(0&lt;x&lt;1\)</span> and <span class="math inline">\(c=\frac{16}{9}\)</span>, then <span class="math inline">\(\rho(x)=\frac{27}{4}x^2(1-x)\)</span> for <span class="math inline">\(0&lt;x&lt;1\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>  my_beta32 <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)<span class="co">#生成的Beta分布记录</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">0</span><span class="co">#Beta分布的指标集合</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>    <span class="cf">while</span> (i <span class="sc">&lt;</span> n) {</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) </span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="cf">if</span> ( <span class="dv">27</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">&gt;</span> u) {</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>      y[i] <span class="ot">&lt;-</span> x</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>      }</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>    }</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_beta32</span>(n)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n)),<span class="fu">c</span>(X, Y))</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">values =</span> <span class="fu">c</span>(X,Y),</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>                   <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Acceptance-rejection&quot;</span>, <span class="dv">100</span>),</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="st">&quot;Beta&quot;</span>, <span class="dv">100</span>)))</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Obviously, when the sample size is 100, there is a significant
difference in the histograms. We consider larger sample sizes of 1000,
10000, 100000, and 1000000.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_beta32</span>(n)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n)),<span class="fu">c</span>(X, Y))</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">values =</span> <span class="fu">c</span>(X,Y),</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>                   <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Acceptance-rejection&quot;</span>, <span class="dv">100</span>),</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="st">&quot;Beta&quot;</span>, <span class="dv">100</span>)))</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_beta32</span>(n)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n)),<span class="fu">c</span>(X, Y))</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">values =</span> <span class="fu">c</span>(X,Y),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>                   <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Acceptance-rejection&quot;</span>, <span class="dv">100</span>),</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="st">&quot;Beta&quot;</span>, <span class="dv">100</span>)))</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_beta32</span>(n)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n)),<span class="fu">c</span>(X, Y))</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">values =</span> <span class="fu">c</span>(X,Y),</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>                   <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Acceptance-rejection&quot;</span>, <span class="dv">100</span>),</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="st">&quot;Beta&quot;</span>, <span class="dv">100</span>)))</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">my_beta32</span>(n)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,n),<span class="fu">rep</span>(<span class="dv">1</span>,n)),<span class="fu">c</span>(X, Y))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">values =</span> <span class="fu">c</span>(X,Y),</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>                   <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Acceptance-rejection&quot;</span>, <span class="dv">100</span>),</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>                             <span class="fu">rep</span>(<span class="st">&quot;Beta&quot;</span>, <span class="dv">100</span>)))</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACAVBMVEUAAAAAADoAAGYAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OmY6OpA6kNtNTU1NTVNNTVZNTW5NTXlNTY5NXp1NY25NZG9NZX9NbmNNbp1NbqtNb2RNg45Ng8hNjrVNjshOTWBSTVBTTU1TTVxTTWlWvsBXTVBYtLVZTW9ZTY5at7hbwsVcTY5eTU1eXE1eXk1eneRjTY5kTU1kTW5kTY5mAABmADpmAGZmOgBmOpBmZjpmZmZmtrZmtv9pTW5pbqtrTW5uTU1uTVluTWRuTWluTW5uTW9uTYNuTY5uY01uaX9ubqtuq81uq+RvTW5vZE1vtf9vzf95TWR5TY55eU1/aW6DTU2Djm6D5P+N2duOTU2OTWCOTWOOTWSOTW6OTXmOTY6Obm6Og02OtauOyMiOyOSOyP+QOgCQOjqQOmaQZgCQkDqQkGaQtpCQvb2Q27aQ2/+R3uCSrKuWsbCXxMWZ5eedW1GdXlmdZE2dnW6ijk2i//+rbk2rbmOrbm6rbo6rtX+rtY6ryKur5Mir5OSr5P+1q262ZgC225C2/9u2///Ie03Ig03Ijk3IyI7I5KvI/8jI///bkDrb25Db/9vb///kq27k/+Tk///r6+vwvLny8vL0wL38yMX/tWT/tmb/yI7/25D/29v/5Hr/5I7/5Kv//6L//7b//8j//9v//+T////LpHKDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKVElEQVR4nO2diX8bRxXHV8aqYyJBWs4UKFcxuNytnAIVECAQjrRAuRSOAgW50HZjUoUjuC1QFBWBoRK1kxqCLEDI8v6VzJsZra7ZfdrV6ljt7/uJ9pBG0u7Xb96sdnYnlgN8sea9AYsOBDFAEAMEMUAQAwQxRCHolVfEPzXpPowLEXzV7IEgBghigCAGCGKAIAYIYoAgBghigCAGCGKYqiAbgiTegg4hiPAUdK8NQYSXoNsbtg1BjqegwxIEKSCIAYLCcbu0Wbpveh8/I6YXQQVbRNAGIsiBIBazIBuCukAQg5+gQwjyErQBQV38BNkQBEEsEMRgFFSAIBcIYjAKsrWgaxDkL6gEQRDEYRJ0DYJ6QBCDSVAJgnpAEAMEMfgLsiEIghggiMEkaBOCekAQAwQxJFXQUTZ7V81xji9nz97ymCkSKqh1seYc3OOc7BY9Zxp/QfcuqyBCSDr+Yc1zpkv5C9pYZkEiSlpfvuUc/6BsnIkSdwhM79wsbZZKajKNzZ4dfoJa58+UnaOz0oVxpssZIqiQkAjyCp1eBBEGQXZCBDl7xXA5KAmCdDU62b2k2i3DTJNQQc5BNityULjjoEQIGptRQYcQ1A8EMYwKsvsFFSAIgvxhBNkQBEH+QBADBDFAEAMEMUAQAwQxjAiyIWgACGKAIAYIYoAgBghi4ATZEARBvowIugpBA0AQw4igDQjyx71uQU1K0/iOWYEIYoAgBghigCAGCGKYhqBDCBpkWJANQYNAEAMr6BoE+QsqQRAE+QFBDBMKaues1NPr1eb6k9ZKtbNtWWnHaZ7akZPmqacsa3U/go0My/wFtXMZ8VipNteEmM52Wj5cQWvkLB3BRoZl/oIaK1XHqZOgvF4Rk56gvA6neTEFQbeDCapTDWquKycNuUJVa6c3b+fyEWxlSKYgqARBQ0wmaKBWNVI7hiq2Xo1gK0Myf0FukiYn3SRNT3a2U8uZpAMKks38U1qQo5t5p7lmWQ9tqWZ+nn4WQRDR8DjWmWsDJpm/IEo7nrVosQTp1kJmzSBMGEF1y7sWQdDC0xNEf0hF0KQ4JOi+JRUU/oCMFfTMkggaonU+my2GuCVzc0TQ5rIIooMPgcpBdNt360I5+NAUyytosLE9IgFhbgsPKOgfZqazu8Hxz0H8wAKGoSn6L+xQV3f4jk7xTyMLKaizPSSIbo8PPjRFwAiKkaDhI6Djy5ccbnATIjGCxK/GviQtWjHRhjlTz0ExEjSI8mMek8J3aIqkCDrIEsWpHwfFSNBQFRubQUH28gpStLeC/oBOmCDPk1eeTFcQ8wcLdMK688TgZ1FfAfN+k6DFqmKNT2T8vnyiM/pjvNkgqLJQEdR54srH9tWJ653eVPwN2+eeFCtymX5D5p3m6Z/TbKCQtPDqB1eqapUiSL9Apa6IxReFI/VU9/3egnSSTi1UDmqe3q/k5UF+Y/VlOd2vZJw6dXys7lMH0XqVKiFVlrUMvdrpLyQ/gbqO1CoJ0kuy1N9VFavIN+r3+wgKy1QF1cVWp3VdUFPy0T5XpV+OYod1LRFP0JKbVHQhR79Lr4ryesn9QBJ8ThbQ74+ZIOoGokp0mv6yaioDPSX31Knk5S5VZBktqL+QeCHdVJWIVkmQWtIfKAVRAa2aEyRPu/rmxHCCCqEFyR3RGroRpAKDBKndoljS+9mLoHPunkpBapUE9cIqeATVVfYKamhAUMEkyA4tqE5Zs5GmlNFc/5OcVlXKaOfSMnNoM6e6O9jpL+S6UKs6B+lM1Vx/cSAHsYIi6dWwIxXU+ZlOKEOtGE23Pm7JLrWVqgj8Vz2Y7+5gfyFXkFrVrVhqRz8h3tzXisVRkA/Bj/hDvSfyKrbIguohruaLPEnPTNCMiLyZh6BRJhMUo14N0SJkvC+08CY5girkJrihyQT9wshCCppPM58wQYVlFhTFcZC91IKcxsTHQUsuKBwQxABBASgNXtihr+7wG70jAYKmGUHqmi73VPrs70pYeEFkpHcxMAQZBbm9NX2dPLMiFoLoxLTqrel18kSw3WMRtaANs6DDyXLQ6v5Ab03/KflpMyNB9mRVbDvf7a1xO3ki2O6xiIUgp5Lv9dboTp4ItnssYiGI6pfbNaM7eSLY7rFYeEHd4yDdb+N28kSw3WOx6ILmDgQxQBBDxIKuQZCByQTFqVcjJH2CSsEFLTgQxABBDBDEAEEMEMQAQQwQxBCtIBuCTEAQQ3IFyft2g9ySmTBBR9m7auYxKbyGpkiWoL0zfxARFOi2cE9BV5dRkKpigYamKA1ft9C9eMF3cIqFhhUUaGgKzwjaSGwEEckWFE0OWmJBQYamsJMoKMhxUOIEjQkEMUAQAwQxQBADBDG4gq5CkBFX0AYEGYEgBghigCAGCGKAIAYIYoAghq4gG4LMQBADBDFAEAMEMYwjqABB/oJsCJL/pw8EmYAgBggaj1LvWo7Rqzv8BqdYaBBBDBDEAEEMEQp6BoI80II2IcgDCGKAIAYIYoAgBiWoAEFeKEE2BHkBQQwQxABBDBDEoO5CgCBPIIgBghggiEFdIg1BnkAQw1iCbAiCIC/U1XcQ5AkEjTJySyYEDTAyNIUNQQOM3BYOQYN4DU2xhIQT5DU0hfswLkS31TNk0ggiIGgEr6EpIEjjMTQFBLl4DNEFQUYgiAGCGCCIAYIYIIjljiAL8QKCGCCIAYIYov5vRJcOCGKAIAYIYoAghgkEuac8xEJ3eE5B0XEOaE6jdR9/K6ueks+MDOEZB8ILcrt+Tna/WDx4Ew3w+sj9v7n7LRfKzt4j3yjSS6LIUfbOvwojez81DWUeB8ILck+7Hj/2aK114SO148e+fk/r8w9cL548+4UfldVIwtfP/O5dny47J8+9YBpGOA6EF+SeuG996VO3jr//cFnOv/fZh8uqqmW/Kov89z1v1ZWvODIQdRwIL8jt+jl6w1kp6Oj1Yv7dD3zYaX3mjZ/847Of+6YcuPw/7/iacHjh92dvPvfC8FDmcSDiCPrfR99dVi/t3f/jIs3/9Zrv6NJ7P0lWBBly0KN/O//eB2rqpb+873qR5n9++2916b3Hk5WD3K6fk90PXVKt2Aff+e27xTNHb/71627+6m3P10SRk1/eWaPqeHP3K8/fGB7KPA5MfBxETZM8DmpdfEkd9Tx+8QbNzoiG7KXL2de+n2LmRgKPgxICBDFAEAMEMUAQAwQxRC+oeWon8s+cIxDEAEEMkwvqbGfEtL5Sba5ZlpUhQdIRTTrblrVSFcv0Un7yrZ0DEURQfXWfLLVzeeWpJ6iznZYvq/W1WBqKQBDtvnj8e18t9wlqUPQIcc316uRfMyciEER1jKLIaYh6lOoXVLckGadiWenJv2guRJGkG6svC0ftXGpnKIKkNkU7J5NR/IhCUHvraVGHGjKIBiJIrPWVyiU1BzmiBqWlG5GIpaB2LiMqXkokaSFNPC9zUUyb/0gENWQTLhJN6orIyJSzRbP+0JZq5imKVHaK4qtmDn6LMUAQAwQxQBADBDFAEAMEMUAQAwQxQBDD/wGeus/wNYmY8gAAAABJRU5ErkJggg==" /><!-- --></p>
<p>As the sample size increases, the distribution generated by the
my_beta32 function gradually approaches the actual Beta distribution. In
sample sizes of 100000 and 1000000, the two histograms almost completely
coincide. We can conclude that the my_beta32 function generates the
Beta(3,2) distribution.</p>
</div>
<div id="homework-1.4" class="section level3">
<h3>homework 1.4</h3>
<p>The rescaled Epanechnikov kernel is a symmetric density function</p>
<p><span class="math display">\[
f_e(x)=\frac{3}{4}\left(1-x^2\right), \quad|x| \leq 1 .
\]</span></p>
<p>Devroye and Györfi provide the following algorithm for simulation
from this distribution. Generate iid <span class="math inline">\(U_1,
U_2, U_3 \sim \operatorname{Uniform}(-1,1)\)</span>. If <span class="math inline">\(\left|U_3\right| \geq\)</span> <span class="math inline">\(\left|U_2\right|\)</span> and <span class="math inline">\(\left|U_3\right| \geq\left|U_1\right|\)</span>,
deliver <span class="math inline">\(U_2\)</span>; otherwise, deliver
<span class="math inline">\(U_3\)</span>. Write a function to generate
random variates from <span class="math inline">\(f_e\)</span>, and
construct the histogram density estimate of a large simulated random
sample.</p>
</div>
<div id="answer-1.4" class="section level3">
<h3>answer 1.4</h3>
<p>Following Devroye and Györfi’s construction method, we obtain the
my_kernel function as follows.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>  my_knernel <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(n)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>    <span class="cf">while</span>(i <span class="sc">&lt;</span> n){</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>      i <span class="ot">&lt;-</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>      U1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>      U2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>      U3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="at">min=</span><span class="sc">-</span><span class="dv">1</span>,<span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">abs</span>(U3) <span class="sc">&gt;=</span> <span class="fu">max</span>(<span class="fu">abs</span>(U1),<span class="fu">abs</span>(U2))){</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>      y[i] <span class="ot">&lt;-</span> U2</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>      y[i] <span class="ot">&lt;-</span> U3</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>      }</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>    }</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">length=</span>n)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  y0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>    <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  }</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">my_knernel</span>(n)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y1)</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>y1))<span class="sc">+</span> <span class="fu">geom_density</span>()<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun=</span>y0,<span class="at">color=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAOpAAZrYkJCQzMzM6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQ2/+pVWSrbk2rbm6rbo6rjk2ryKur5OSr5P+xsbG2ZgC2/9u2//+9vb3Ijk3I///bkDrb/7bb///fU2vkq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8B+M2hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMbUlEQVR4nO3de2OcxhEA8LEt6sayEzVy2jh9WMZpWqNa8jUoyJIi8f0/VVieC+yL3Vl24Wb+iO4ydzD8vHC8doGSQhkQuoDYA0IXEHtA6AJiDwhdQOwBoQuIPSB0AbEHLP5G0Qf3chIrZXzOhoA0GQLSZAhIkyEgTYaANBkC0mQISJMhIE2GgDQZAtJkogXKqjD9ztEDta9LkZq3Arp3eqDffzr99rf61f3b0zdfCGgSTx/flzff1VJ//1TetFYENDSgf3wp7//KGs79j7/V7whoFDVL1Xb4FvSnKqRfwImrKmav+f+5coA08/XbDojbGpXUgvoYWtD9D5/Kr28CrWJVXGVRAg3bIK4tEdAQTx/ftb9iQVtQkiSRArVbHtaIvp6evu4a0KpAlU7S/CdGIEl4rm8AAki6VYwJ4c5Gm4kfCIDfBiUJ7my0mdiBKp7xRjoB1NloM5ED9a1n+BUD4D/gr4DuXcxAzGIGVLRCBJQl7d8xULcdOnqg6her/jsHygioYEDZAJQO0WyHCgLq9gmzXqVpQfXbAo4eCNrlz1PBKpbm7c6RxwL6d3ECtcuf58JtEEvAUQM1a1CaF+KNdN+0vBXAvYsRqN7/YZuaQg5UJO0HfBTAv4sQqN4R7BqIHChpmpiHAkbvIgJqFr2s95TzTAdU7yjlqAWIMvEBMZ/xxlkClLE9yRyzAFEmOqDapyhMgOo96sryqIAAyqZVmADVe9TVx48IKIGizAU2MqBG6HiA2HG6cPMjAWpPfeRIBYgy9kC4wa6ZXiXJVZm3r5XRfaOrO/dfICz+BuY/U3dlJ8vYBmVBC2qaUCltQ/tZxWqg6uiCZzABqoVK6Vq2K6DGxwiIh6qB2GkQtwJkmXiA2KGDmEENVAk1a6WoEe0KqPFZDlRAe9uHQGhHQO0KtgyoUerOnu0aqFvBbIAqoebvXGhHQJ2PDVDZn6C1L0CWiQYo1TAogfpT/FOh3QBBqmNQZa6y7iLRVGgvQFA4AyVjoKZp7QcoN2BQAvX3xbRC+wIC/gjeEqi/L6YR2hdQXiAAdffF7BAoFSytBVDBC+0JKE+QgHihXQEZMuiBuBOMOwJqrrLjABVFJ7QfoBwK0dJaArU/9/lugKpD+ES4tNZA9bWgHQHNfNyB2Jaou3K9eaA0wwPqot5WpysCDb3Enj5i9tVgCzNvQBhA7cHvSkBDn9Xy+n3dJQoPSOCDA1SfPlkJaOgvNvRXRQISrGBYQMx+JSCux+GPv7SrGEqf1aur9CrRX0W1jTRpZoLUyxWkmaGf4f3b9zVXE+4tSNiA3FtQGynbISr7JrVOC0LtkincAuEBZSmsA8Rtg/6FCiRuQIhA7JLiCkBDn1X2K4a4ivkGyvJ1gLg+q9UrvLE7crEPJlABqwBJwhEoL8Q+iEDVIRl/Pz4BzYCKfLtAebEKUCnpSL4FIBAvFSpQczp3i0B5CesAZeKe9lsAkt2KiApUptsEyov1gJJtAoHwXnp8oPaoflNA7DQHlCsA1Zk0Ew1mQUBDJt0eUJoRkAYoKdYDqk97bAqoPoq3YCAgT0DstMeWgPK60woBqYDsGKyBhD1dIgZKLBmOBKg9D7QukGAdixcIbBnsgVx6cawNlEMQoHkT8g9kFzkYdEn1cJnVuXBY/A2rFpR349qt2YIydo0MswU9nD374AuoO82xMlBi3Q9I3IIuAV78igxU/0NCEQZo3l/TdRv0cAbwCh8omVW+EhDYdpSSATVEzz/vBci6J5kM6ABwUq1qihXNAoi7nWPbQI8XAOfsxa2iCdkAOTG4AU3XMbdfMdWqZQ/E3w+0cSBt89ke0FQoSiA3Bleg8WbIHqjaPLdxovJZDpQKK18NaNKEEFqQJrYHNGpC8R3Nj2/Z3C5Q1XzYLiIL3G2Qc8dLdyBeKLoWBMGBCsjS4VaP6IDcO14iAGUpDlCzmmn2FrcHVI+gggJ0eVIenn8+YP7MTwf/CwQ0nDlz/Jl/vDjB3FEc7yQGA2KjXCEBPZy9QgVKdgX0ePHq9tkHtqKhAU19ggH1pxadtkF3L6vDDNW5oKVAswa0cSCjWAI081kdqI1+jG5MIP7Rj6wD63Ig2BtQtYoNhxpcp96yvDndNlCWYACx33iuAfUd6sry/m//tAACwQjR4YAWjoMvAhqf7uA6Yj79/N9mFVvWqRfyEFebxZHYjq3MAz1e8EDcw0Nv3lltg0RDaIdqQRkgtKDxLuKoU68NEEQGtOxJCiKg8fmgYRt0c8ri3VKgXHTHbzCg7rwZ3s8816nX6mce9g7EdepdBNTVJ35IRjCgbm/aDegAcH5wPNSIFagScga6fPH/5owHAlDavY4IqFjwNBcRUH2649z1dAcBGQEl8QE1hxtOq9iBrWLsnJk70PwozJoBEWjB84CEQOUt2w1S+xw3kEkYAcl8ggLVhxsEpMjAgidKzYC64wznS8+skvmpVgcGPCC2N+22kWY0uns8TICkPtsGwrmBilUSL5DxM8m8AsnXsMBA09vNFgJ1q5jzflCKyhARULMfpLnNTA+UxAtUQCkVWu9nPmqgK+5eoVBAKS4DAVlnLIBG9woFAkqiBWIRAZDhAx0RMlYTSwhInUkE/TRRgXRR/YZFHcmynr7LgXQtaOkjQR0ydhNLPLeg7QMJHzxKQENm3hV6TaAcnYGArDO2QOIjVgLqM7O+4isC5YW+PrQMAWky1kAGQy8dNdCsK/R6QO1TwwhIClRsA0g/NtVxAwmb0BpA3TBBBCQDKjYCJBIioD5DQLEC1aPyoTN4ARIIEVCfCQaUmtWHlnGaWACg3M9IZZ6ANMO/EVAIID8MnoCS6TXoxUBDn9X7t6cGXTK5x39vAShzBRr6rLJeY/c/aJ9xuDWg6SXWpUBDf7GvjOm6a0K7AZpepF8KNH54aPNK1Wc10IDIDpGaPKpWDsT1WW1616lbkL/BAL21oMklVpcW9PtPvQ8BdcH1m2fPMtYD4VVumnGdmBvQ0Gd15CMDGg12dxRAQ5/Vptez5ldsi0Dj4zHPe9IEpAbK/Q0nSUDWGeeJjQ5YCWieUQxiig6EW7lZZkNAOcir8JdBAIJVgMaDjmNUbpZxB5IPg0tATXDP0vQJNPEhoP0AcYcbBCTMrATkoXKDDAoQrAA0bUAEtCOg4XiMgMQZVrxnoHzqQ0B7AuovIHoE8lS5NoMElBCQMuMdaHIkj1e5NhMn0CzyrV1RnUaaKJZuOdC8Bc0Hu9tUC+oOWH2tYm33DB+V6zIbARIMl7gtoPZwg4CkGQLSZFI2dpcvIOGgvwS0L6AsJyB1xiOQ4NEZmJWrM3hAbB0jIHmmvoDoBUj08BXMytUZRKCqCRGQPOMNSPhsEczK1Rk8ICZEQPKMLyAQPr4Hs3J1BhFoNhQ3CpB02F8CaoFWGbmegKwzmEDTobgJaBoEpMn4AFpnaP8NA2HWFxxoMmKOAdDQZ5V/4up+gZa2oKHP6uiJqwTUN6C+vxj/xFUC6mP0lEyDPqs7DZBmhj6ro96rkq4I41gp43M2eiBRCyIgLgy2QR7rM8qEBRr6rI6euEpAQxPqn7Mq2w/yWJ9RJjCQJNapzyhDQJoMAWkyBKTJEJAmEyfQEDZHHSt9B282YDEl/CrQv0NAq80GLKaEXwX6d+IAOoqA0AXEHhC6gNgDQhcQe0DoAmIPsPxedwJtdCZEGcMn2ZBfb75oPl5KrzvhzoSFamHAbBLT+NrOfHxFSBXcJ6/faz47/YbxXJbPhIVyYcB4Mnxcv/5Pgz4+G6uK4ZNPP3/Sfnr8DeO5LJ9JqVsYMJ3MJLoRFkfn85Vf6D9ZNWRucGGTbxjPZflMmq8pFgYMpyGZ5viKkCqGT7KBhU3+gWXXnVBnUodqYcBsEkNcn55+Vy5sQew7k08abCKcWpDpTJqv+WtBNtugOgxqd9oGmc6kDtXCgNkkZNMcXxFSxfBJ1pKf/q1fXNl1J9SZ1KFaGDCbhHCasytCyhiuIlW7KK9Ntg6S6064M2GhWhgwnMbRBoQuIPaA0AXEHhC6gNgDQhcQe0DoAmIPCF2AYTz85UOYGUOY2S6Oy2cEpIiHMyAgUVyeVP85nJS3J3d/JiBB3D7/XD5enFevCEgYD2fn5d03n0sCkkW1eh3YakZAkrj75n/1GkZAkni8+L5ewwhIFgeo1zACksXdy/PmLwGJo/kNCxgQdvbaOLwKXAAEnr867l6++DVwCRB4/tEHhC4g9oDQBcQeELqA2ANCFxB7QOgCYg8IXUDs8QdeorVTcQd+ZQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">length=</span>n)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">my_knernel</span>(n)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y1)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>y1))<span class="sc">+</span> <span class="fu">geom_density</span>()<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun=</span>y0,<span class="at">color=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="at">length=</span>n)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">my_knernel</span>(n)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y1)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>y1))<span class="sc">+</span> <span class="fu">geom_density</span>()<span class="sc">+</span><span class="fu">stat_function</span>(<span class="at">fun=</span>y0,<span class="at">color=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">bins =</span> <span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We consider three sample sizes: 10000, 100000, and 1000000. In these
cases, the shaded part represents the probability distribution histogram
generated by the my_knernel function, the black curve represents the
fitted probability distribution function, and the red curve represents
the true probability distribution function. We find that as the sample
size gradually increases, the black curve increasingly approaches the
red curve and eventually almost coincides. Therefore, we can conclude
that the my_knernel function generates a probability distribution that
conforms to the Epanechnikov kernel function.</p>
</div>
<div id="homework-1.5" class="section level3">
<h3>homework 1.5</h3>
<p>Prove that the algorithm given in Exercise 3.9 generates variates
from the density <span class="math inline">\(f_e(3.10)\)</span>.</p>
</div>
<div id="answer-1.5" class="section level3">
<h3>answer 1.5</h3>
<p>Since <span class="math inline">\(u_1, u_2, u_3 \sim
U(-1,1)\)</span>, then <span class="math inline">\(P\left(\left|u_1\right| \leqslant
x\right)=P\left(-x \leqslant u_1 \leqslant x\right)=\frac{1}{2} \cdot 2
x=x, \quad 0&lt;x&lt;1\)</span>. Therefore, <span class="math inline">\(\left|u_1\right|, \left|u_2\right|,
\left|u_3\right| \sim U(0,1)\)</span>. Let the final variable be Y, and
consider the event <span class="math display">\[A=\left\{\left|u_3\right|
\geqslant\left|u_1\right|,\left|u_3\right|
\geqslant\left|u_2\right|\right\} \Leftrightarrow\left\{\left|u_3\right|
\geqslant \max \left(\left|u_1\right|,\left|u_2\right|\right)\right\}
\]</span></p>
<p>Let <span class="math inline">\(\max
\left(\left|u_1\right|,\left|u_2\right|\right)=V\)</span>,</p>
<p><span class="math display">\[
P(V \leqslant x)=P\left(\max
\left(\left|u_1\right|,\left|u_2\right|\right) \leqslant x\right)
= P\left(\left|u_1\right| \leqslant x,\left|u_2\right| \leqslant
x\right) \stackrel{\text { 独立性 }}{=}\left(P\left(\left|u_1\right|
\leqslant x\right)\right)^2=x^2, 0&lt;x&lt;1.
\]</span></p>
<p>Let <span class="math inline">\(\max
\left(\left|u_1\right|,\left|u_2\right|\right)=V\)</span>, <span class="math display">\[P(Y \leqslant x)=P(Y \leqslant x \mid A)
P(A)+P\left(Y \leqslant x \mid A^c\right)
P\left(A^c\right).\]</span></p>
<p>The first term <span class="math inline">\(P(Y \leqslant x \mid
A)=P\left(u_2 \leqslant x \mid A\right)\)</span>, and the second term
<span class="math inline">\(P\left(Y \leqslant x \mid
A^c\right)=P\left(u_3 \leqslant x \mid A^c\right)\)</span>.</p>
Second term
<span class="math display">\[\begin{aligned}
P\left(u_3 \leqslant x,\left|u_3\right|&lt;V\right)
&amp; =\frac{1}{2} \int_{-1}^x P\left(\left|u_3\right|&lt;V \mid
u_3=m\right) d m \\
&amp; =\frac{1}{2} \int_{-1}^x P(V&gt;|m|) d m \\
&amp; =\frac{1}{2} \int_{-1}^x\left(1-m^2\right) d m
\end{aligned}\]</span>
First term
<span class="math display">\[\begin{aligned}
P\left(u_2 \leqslant x, V \leqslant\left|u_3\right|\right)
&amp; =\frac{1}{2} \int_{-1}^x P\left(\left|u_3\right|
\geqslant\left|u_1\right|,\left|u_3\right| \geqslant\left|u_2\right|
\mid u_2=m\right) d m \\
&amp; =\frac{1}{2} \int_{-1}^x P\left(\left|u_3\right|
\geqslant\left|u_1\right|,\left|u_3\right| \geqslant|m|\right) d m \\
&amp; =\frac{1}{2} \int_{-1}^x \int_{|m|}^1 P\left(\left|u_3\right|
\geqslant\left|u_1\right||| u_3 \mid=n\right) d n d m \\
&amp; =\frac{1}{2} \int_{-1}^x \int_{|m|}^1 P\left(\left|u_1\right|
\leqslant n\right) d n d m \\
&amp; =\frac{1}{2} \int_{-1}^x \int_{|m|}^1 n d n \\
&amp; =\left.\frac{1}{2} \int_{-1}^x\left(\frac{1}{2}
n^2\right)\right|_{|m|} ^1 d m \\
&amp; =\frac{1}{4} \int_{-1}^x\left(1-m^2\right) d m
\end{aligned}\]</span>
<p>The probability distribution of the variable <span class="math inline">\(Y\)</span> is as follows:</p>
<span class="math display">\[\begin{aligned}
P(Y \leqslant x)&amp;= P(Y \leqslant x \mid A) P(A)+P\left(Y \leqslant x
\mid A^c\right) P\left(A^c\right)\\
&amp;= P(u_2\leq x,A)+P(u_3\leq x,A^c)\\
&amp;= P\left(u_2 \leqslant x, V
\leqslant\left|u_3\right|\right)+P\left(u_3 \leqslant
x,\left|u_3\right|&lt;V\right)\\
&amp;= \frac{3}{4} \int_{-1}^x\left(1-m^2\right) dm
\end{aligned}\]</span>
<p>Therefore, the probability density function of variable <span class="math inline">\(Y\)</span> is <span class="math inline">\(f_e(x)=\frac{3}{4}(1-x^2), |x| \leq
1\)</span>.</p>
</div>
</div>
<div id="homework-2" class="section level2">
<h2>homework 2</h2>
<div id="homework-2.1" class="section level3">
<h3>homework 2.1</h3>
<ol style="list-style-type: decimal">
<li><p>Prove what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span>? (<span class="math inline">\(m
\sim B(n, p)\)</span>, using the <span class="math inline">\(\delta\)</span> method). For the Buffon needle
problem, we use the Monte Carlo method to estimate <span class="math inline">\(\pi\)</span>. Let <span class="math inline">\(n\)</span> denote the number of Buffon needle
experiments, and <span class="math inline">\(m\)</span> denote the
number of successful experiments. We consider an optimal <span class="math inline">\(\rho=\frac{l}{d}\)</span> that minimizes the
asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span>,
where <span class="math inline">\(\hat{\pi}=\frac{2l}{d\hat{p}}\)</span>, <span class="math inline">\(\hat{p}=\frac{m}{n}\)</span>, <span class="math inline">\(m \sim B(n, p)\)</span>, and here <span class="math inline">\(p=\frac{2 l}{d \pi}\)</span>.</p></li>
<li><p>Take three different values of <span class="math inline">\(\rho\left(0 \leq \rho \leq 1\right.\)</span>,
including <span class="math inline">\(\left.\rho_{\min }\right)\)</span>
and use Monte Carlo simulation to verify your answer. (<span class="math inline">\(n=10^6\)</span>, Number of repeated simulations
<span class="math inline">\(K=100\)</span>). Choose three different
values of <span class="math inline">\(\rho\)</span>, where <span class="math inline">\(0\leq\rho\leq1\)</span>, one of which is <span class="math inline">\(\rho_{min}=1\)</span>. Choose the other two as 0.5
and 0.8. Compare the variance of <span class="math inline">\(\hat{\pi}=\frac{2\rho}{\hat{p}}\)</span> under
these three values of <span class="math inline">\(\rho\)</span> using
the Monte Carlo method.</p></li>
</ol>
</div>
<div id="answer-2.1" class="section level3">
<h3>answer 2.1</h3>
<ol style="list-style-type: decimal">
<li>First, consider the asymptotic distribution of <span class="math inline">\(\hat{p}\)</span>. Since <span class="math inline">\(m\)</span> denotes the number of successful needle
experiments and each experiment is independent, <span class="math inline">\(E(\hat{p})= p = \frac{2l}{d\pi}\)</span>, <span class="math inline">\(Var(\hat{p})=\frac{p(1-p)}{n}\)</span>. Then by
the central limit theorem,</li>
</ol>
<p><span class="math display">\[
\sqrt{n}\left[\hat{p}-p\right] \rightarrow^d N\left(0, p(1-p)\right).
\]</span></p>
<p>(Delta Method) Let <span class="math inline">\(Y_n\)</span> be a
sequence of random variables satisfying <span class="math inline">\(\sqrt{n}\left(Y_n-\theta\right) \rightarrow^d
N\left(0, \sigma^2\right)\)</span>. For a given function <span class="math inline">\(g(\cdot)\)</span> and value <span class="math inline">\(\theta\)</span>, if <span class="math inline">\(g^{\prime}(\theta)\)</span> exists and is
nonzero,</p>
<p><span class="math display">\[
\sqrt{n}\left[g\left(Y_n\right)-g(\theta)\right] \rightarrow^d N\left(0,
\sigma^2\left[g^{\prime}(\theta)\right]^2\right).
\]</span></p>
<p>Let <span class="math inline">\(g(x)=\frac{2l}{dx}\)</span>, <span class="math inline">\(g^{\prime}(x)=-\frac{2l}{d}\frac{1}{x^2}\)</span>,
<span class="math inline">\(\theta=p\)</span>, then by the Delta
method,</p>
<p><span class="math display">\[
\sqrt{n}\left[\hat{\pi}-g(p)\right] \rightarrow^d N\left(0,
p(1-p)\left[g^{\prime}(p)\right]^2\right).
\]</span></p>
<p>The asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span> is then</p>
<span class="math display">\[\begin{aligned}
\frac{1}{n}p(1-p)\left[g^{\prime}(p)\right]^2 &amp;=
\frac{1}{n}p(1-p)(\frac{2l}{d}\frac{1}{p^2})^2 \nonumber \\
&amp;= \frac{1}{n}(1-p)(\frac{4l^2}{d^2})\frac{1}{p^3} \nonumber \\
&amp;= \frac{\pi^3}{2n}(\frac{d}{l}-\frac{2}{\pi}) \nonumber
\end{aligned}\]</span>
<p>And since <span class="math inline">\(p=\frac{2l}{d\pi} \leq
1\)</span> and <span class="math inline">\(l \leq d\)</span>, then <span class="math inline">\(\frac{d}{l} \geq 1\)</span>. Thus, when <span class="math inline">\(\rho=\rho_{min}=\frac{l}{d}=1\)</span>, the
asymptotic variance is minimized at <span class="math inline">\(\frac{\pi^3}{2n}(1-\frac{2}{\pi})\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>We generate a set of samples of size <span class="math inline">\(n\)</span>, following a binomial distribution with
parameter <span class="math inline">\(p=\frac{2\rho}{\pi}\)</span>. For
the three different values of <span class="math inline">\(\rho\)</span>,
we consider the variance of the statistic <span class="math inline">\(\hat{\pi}\)</span>. The <span class="math inline">\(\rho\)</span> corresponding to the smallest
variance in each experiment is recorded in the result vector, and the
experiment is repeated 100 times.</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(K)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  rho <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">1</span>) </span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  rhomin <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  pi1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(K)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  pi2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(K)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  pi3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(K)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>    sample1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="at">prob=</span><span class="dv">2</span><span class="sc">*</span>rho[<span class="dv">1</span>]<span class="sc">/</span>pi)<span class="co">#rho=0.5</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>    sample2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="at">prob=</span><span class="dv">2</span><span class="sc">*</span>rho[<span class="dv">2</span>]<span class="sc">/</span>pi)<span class="co">#rho=0.8</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>    sample3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="at">prob=</span><span class="dv">2</span><span class="sc">*</span>rho[<span class="dv">3</span>]<span class="sc">/</span>pi)<span class="co">#rho=1</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>    pi1[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho[<span class="dv">1</span>]<span class="sc">*</span>n<span class="sc">/</span>sample1</span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>    pi2[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho[<span class="dv">2</span>]<span class="sc">*</span>n<span class="sc">/</span>sample2</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>    pi3[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>rho[<span class="dv">3</span>]<span class="sc">*</span>n<span class="sc">/</span>sample3</span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>  }</span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>  <span class="fu">var</span>(pi1)</span></code></pre></div>
<pre><code>## [1] 1.539082e-05</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>  <span class="fu">var</span>(pi2)</span></code></pre></div>
<pre><code>## [1] 8.127361e-06</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>  <span class="fu">var</span>(pi3)</span></code></pre></div>
<pre><code>## [1] 4.521876e-06</code></pre>
<p>From the results of 100 simulations, we know that the variance of
<span class="math inline">\(\hat{\pi}\)</span> is smallest when <span class="math inline">\(\rho=\rho_{min}=1\)</span>. This is consistent
with our theoretical results, confirming the validity of <span class="math inline">\(\rho_{min}=1\)</span>.</p>
</div>
<div id="homework-2.2" class="section level3">
<h3>homework 2.2</h3>
<p>In Example 5.7, the control variate approach was illustrated for
Monte Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^x d x
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(\operatorname{Cov}\left(e^U,
e^{1-U}\right)\)</span> and <span class="math inline">\(\operatorname{Var}\left(e^U+e^{1-U}\right)\)</span>,
where <span class="math inline">\(U \sim
\operatorname{Uniform}(0,1)\)</span>. What is the percent reduction in
variance of <span class="math inline">\(\hat{\theta}\)</span> that can
be achieved using antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-2.2" class="section level3">
<h3>answer 2.2</h3>
<p>In the given problem, <span class="math inline">\(\theta=\int_0^1 e^x
d x = E\left[e^X\right], X \sim U(0,1)\)</span>. Theoretically, the
variance of <span class="math inline">\(\hat{\theta}\)</span> obtained
by the simple MC method is as follows. Let <span class="math inline">\(X_i \sim U(0,1), i=1,2,\dots,n\)</span>, <span class="math inline">\(\hat{\theta}=\frac{1}{n}\sum_{i=1}^ne^{X_i}\)</span>,
the variance is <span class="math display">\[
  Var(\hat{\theta})=\frac{1}{n}Var(e^{X_1})=\frac{1}{n}(Ee^{2X_1}-(Ee^{X_1})^2)=\frac{-e^2+4e-3}{2n}.
\]</span></p>
<p>The antithetic variates method constructs <span class="math inline">\(\theta=E\left[e^X\right]=E(\frac{e^U+e^{1-U}}{2}),
U \sim U(0,1)\)</span>. Similarly, let <span class="math inline">\(U_i
\sim U(0,1), i=1,2,\dots,n\)</span>, <span class="math inline">\(\tilde{\theta}=\frac{1}{n}\sum_{i=1}^{n/2}(e^{U_i}+e^{1-U_i})\)</span>,
the variance is <span class="math display">\[
  Var(\tilde{\theta})=\frac{1}{2n}Var(e^{U_1}+e^{1-U_1}).
\]</span></p>
<p>Here, <span class="math inline">\(Cov(e^U, e^{1-U})=e-e \times E e^U
\times E e^{-U}=-e^2+3e-1\)</span>, <span class="math inline">\(Var(e^U+e^{1-U})=2Cov(e^U,
e^{1-U})+Var(e^U)+Var(e^{1-U})=-3e^2+10e-5\)</span>, hence the variance
of <span class="math inline">\(\tilde{\theta}\)</span> is <span class="math display">\[
  Var(\tilde{\theta})=\frac{-3e^2+10e-5}{2n}.
\]</span></p>
<p>When using the antithetic variates method, compared to the basic
simple MC method, the ratio of variances is <span class="math inline">\(\frac{Var(\tilde{\theta})}{Var(\hat{\theta})}=\frac{-3e^2+10e-5}{-e^2+4e-3}=0.03232993\)</span>,
<span class="math inline">\(\frac{Var(\hat{\theta})}{Var(\tilde{\theta})}=\frac{-e^2+4e-3}{-3e^2+10e-5}
=30.93109 \approx 31\)</span>. By using the antithetic variates method,
theoretically, the variance of the estimator can be reduced to <span class="math inline">\(\frac{1}{31}\)</span> of its original value
(compared to the basic simple MC method).</p>
</div>
<div id="homework-2.3" class="section level3">
<h3>homework 2.3</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> using the antithetic variate
approach and the simple Monte Carlo method. Compute an empirical
estimate of the percent reduction in variance using the antithetic
variate. Compare the result with the theoretical value from Exercise
5.6.</p>
</div>
<div id="answer-2.3" class="section level3">
<h3>answer 2.3</h3>
<p>We verify the correctness of the theoretical results from Answer 2
through simulation experiments, where <span class="math inline">\(n=1
\times 10^6\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(B)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>  V0 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(x))<span class="sc">/</span>B</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  V0</span></code></pre></div>
<pre><code>## [1] 2.417935e-07</code></pre>
<p>The variance of <span class="math inline">\(\hat{\theta}\)</span>
obtained by the simple MC method is <span class="math inline">\(2.417935
\times 10^{-7}\)</span>, and the theoretical variance is <span class="math inline">\(\frac{-e^2+4e-3}{2n} = 2.420356 \times
10^{-7}\)</span>. The results are very close, indicating that the
empirical variance estimate obtained by simulation is accurate.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(B<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  V <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(x)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>B)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  V</span></code></pre></div>
<pre><code>## [1] 7.800207e-09</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>  V0<span class="sc">/</span>V</span></code></pre></div>
<pre><code>## [1] 30.99834</code></pre>
<p>The variance of <span class="math inline">\(\hat{\theta}\)</span>
obtained by the antithetic variates method is <span class="math inline">\(7.800207 \times 10^{-9}\)</span>, and the
theoretical variance is <span class="math inline">\(\frac{-3e^2+10e-5}{2n} = 7.824994 \times
10^{-9}\)</span>. The results are very close, indicating that the
empirical variance estimate obtained by simulation is accurate. The
ratio of the variance estimate obtained by the simple MC method to that
obtained by the antithetic variates method is <span class="math inline">\(30.99834 \approx 31\)</span>, which is very close
to the theoretical ratio of <span class="math inline">\(30.93109\)</span>, suggesting that the theoretical
variance ratio calculated in Answer 2 is accurate.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="dv">10000</span>; k <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># what if k is larger?</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>  r <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co">#replicates per stratum</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>  T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>  est <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>  g<span class="ot">&lt;-</span><span class="cf">function</span>(x)<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">*</span>x)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>  est[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M)))</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)T2[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">g</span>(<span class="fu">runif</span>(M<span class="sc">/</span>k,(j<span class="dv">-1</span>)<span class="sc">/</span>k,j<span class="sc">/</span>k)))</span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a>  est[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(T2)</span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>  }</span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,mean),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.5243 0.5248</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">apply</span>(est,<span class="dv">2</span>,sd),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.002 0.000</code></pre>
</div>
</div>
<div id="homework-3" class="section level2">
<h2>homework 3</h2>
<div id="homework-3.1" class="section level3">
<h3>homework 3.1</h3>
<p><span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^M\right)=\frac{1}{M
k} \sum_{i=1}^k
\sigma_i^2+\operatorname{Var}\left(\theta_I\right)=\operatorname{Var}\left(\hat{\theta}^S\right)+\operatorname{Var}\left(\theta_I\right)\)</span>,
where <span class="math inline">\(\theta_i=E[g(U) \mid I=i],
\sigma_i^2=\operatorname{Var}[g(U) \mid I=i]\)</span> and <span class="math inline">\(I\)</span> takes a uniform distribution over <span class="math inline">\({1, \ldots, k}\)</span>.</p>
<p>Prove that if <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a, b)\)</span>, then <span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^S\right) /
\operatorname{Var}\left(\hat{\theta}^M\right) \rightarrow 0\)</span> as
<span class="math inline">\(b_i-a_i \rightarrow 0\)</span> for all <span class="math inline">\(i=1, \ldots, k\)</span>.</p>
</div>
<div id="answer-3.1" class="section level3">
<h3>answer 3.1</h3>
<p>Where<span class="math display">\[\operatorname{Var}\left(\hat{\theta}^S\right)=\frac{1}{M
k} \sum_{i=1}^k \operatorname{Var}[g(U) \mid I=i].\]</span></p>
<p>Let <span class="math inline">\(\bar{\theta}=\mathbb{E}
\theta_I=\mathbb{E}\left[\mathbb{E}\left(\theta_I \mid
I\right)\right]=\sum_{i=1}^k \mathbb{P}(I=i) \cdot
\mathbb{E}\left(\theta_I \mid I=i\right)=\frac{1}{k} \sum_{i=1}^k
\theta_i\)</span>. Then</p>
<p><span class="math display">\[
\frac{1}{M} \operatorname{Var}\left(\theta_I\right)=\frac{1}{M}
\mathbb{E}\left[\theta_I-\mathbb{E} \theta_I\right]^2=\frac{1}{M}
\mathbb{E}\left(\theta_I-\bar{\theta}\right)^2=\frac{1}{M}
\mathbb{E}\left\{\mathbb{E}\left[\left(\theta_I-\bar{\theta}\right)^2
\mid I\right]\right\}=\frac{1}{M} \sum_{i=1}^k \mathbb{P}(I=i) \cdot
\mathbb{E}\left[\left(\theta_I-\bar{\theta}\right)^2 \mid
I=i\right]=\frac{1}{M k}
\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2.
\]</span></p>
<p>The problem is equivalent to proving <span class="math inline">\(\frac{\operatorname{Var}\left(\hat{\theta}^S\right)}{\frac{1}{M}
\operatorname{Var}\left(\theta_I\right)} \rightarrow 0\)</span>.</p>
<span class="math display">\[\begin{aligned}
\frac{\operatorname{Var}\left(\hat{\theta}^S\right)}{\frac{1}{M}
\operatorname{Var}\left(\theta_I\right)} &amp; =\frac{\frac{1}{M k}
\sum_{i=1}^k \operatorname{Var}[g(U) \mid I=i]}{\frac{1}{M k}
\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2} \nonumber\\
&amp; =\frac{\sum_{i=1}^k \operatorname{Var}[g(U) \mid
I=i]}{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2} \nonumber\\
&amp; =\frac{\sum_{i=1}^k \operatorname{Var}\left[g\left(U_{1
i}\right)\right]}{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2}
\nonumber\\
&amp; =\frac{\sum_{i=1}^k \mathbb{E}\left[g\left(U_{1
i}\right)-\mathbb{E} g\left(U_{1
i}\right)\right]^2}{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2}\nonumber
\end{aligned}\]</span>
<p>Notice that <span class="math inline">\(\theta_i=\mathbb{E}[g(U) \mid
I=i]=\mathbb{E} g\left(U_{1 i}\right)\)</span>, and <span class="math inline">\(U_{1 i} \sim \operatorname{Uniform}\left(a_i,
b_i\right)\)</span>, so the above expression becomes</p>
<p><span class="math display">\[
\frac{\sum_{i=1}^k \mathbb{E}\left[g\left(U_{1
i}\right)-\theta_i\right]^2}{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2}=\frac{\sum_{i=1}^k
\mathbb{E}\left[g\left(U_{1
i}\right)-\bar{\theta}+\bar{\theta}-\theta_i\right]^2}{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2}=\frac{\sum_{i=1}^k
\mathbb{E}\left[g\left(U_{1
i}\right)-\bar{\theta}\right]^2}{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2}-1
\]</span></p>
<p>Clearly, when <span class="math inline">\(b_i-a_i \rightarrow
0(\Rightarrow k \rightarrow \infty)\)</span>, the above expression tends
to <span class="math inline">\(\frac{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2}{\sum_{i=1}^k\left(\theta_i-\bar{\theta}\right)^2}-1=0\)</span>.</p>
</div>
<div id="homework-3.2" class="section level3">
<h3>homework 3.2</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to <span class="math display">\[
g(x)=\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1 .
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-3.2" class="section level3">
<h3>answer 3.2</h3>
<p>The integrand function is <span class="math display">\[
g(x)= \begin{cases}\frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2}, \quad x&gt;1
\\ 0, \quad \text { otherwise. }\end{cases}
\]</span></p>
<p>Assuming <span class="math inline">\(f(x)\)</span> is the
corresponding importance sampling density function, where <span class="math inline">\(X\)</span> has a density function <span class="math inline">\(f(x)\)</span> on <span class="math inline">\((1,\infty)\)</span>, then <span class="math display">\[
\theta=\int_1^\infty g(x) d x=\int_1^\infty \frac{g(x)}{f(x)} f(x) d
x=E\left[\frac{g(X)}{f(X)}\right] .
\]</span></p>
<p>Assuming <span class="math inline">\(X_1, \ldots, X_n\)</span> are a
sample from population <span class="math inline">\(X\)</span>, the
estimator of <span class="math inline">\(\theta\)</span> can be
expressed as <span class="math display">\[
\hat{\theta}=\frac{1}{n} \sum_{i=1}^n
\frac{g\left(X_i\right)}{f\left(X_i\right)} .
\]</span> For a given density function <span class="math inline">\(f(x)\)</span>, the variance of the estimator <span class="math inline">\(\operatorname{Var}(\hat{\theta})\)</span> can be
expressed as</p>
<span class="math display">\[\begin{aligned}
\operatorname{Var}(\hat{\theta})=&amp;E\left[\hat{\theta}^2\right]-(E[\hat{\theta}])^2
\nonumber\\
&amp;=\frac{1}{n^2}E(\sum_{i=1}^n
\frac{g\left(X_i\right)}{f\left(X_i\right)})^2-\theta^2 \nonumber\\
&amp;=\frac{1}{n^2}E(\sum_{i=1}^n(\frac{g\left(X_i\right)}{f\left(X_i\right)})^2+\sum_{i
\neq
j}\frac{g\left(X_i\right)}{f\left(X_i\right)}\frac{g\left(X_j\right)}{f\left(X_j\right)})-\theta^2
\nonumber\\
&amp;=\frac{1}{n^2}(n\int_1^\infty \frac{g^2(x)}{f(x)}
dx+n(n-1)\theta^2)-\theta^2 \nonumber\\
&amp;=\frac{1}{n}(\int_1^\infty \frac{g^2(x)}{f(x)} dx-\theta^2)
\nonumber
\end{aligned}\]</span>
<p>We choose <span class="math inline">\(f_1(x)=\frac{4}{\pi}\frac{1}{1+x^2}(x&gt;1)\)</span>
and <span class="math inline">\(f_2(x)=\frac{e^{1/2}\times
e^{-\frac{x}{2}}}{2}(x&gt;1)\)</span>. Then, we calculate the variance
of <span class="math inline">\(\hat{\theta}\)</span> based on the above
results using the integrate function.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>  f_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">4</span><span class="sc">/</span>pi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  }</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  f_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>  }</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>  </span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>    <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>  }</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a>  </span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a>  g_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">g</span>(x))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">f_1</span>(x))</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  }</span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>  </span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a>  g_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb46-18"><a href="#cb46-18" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">g</span>(x))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">f_2</span>(x))</span>
<span id="cb46-19"><a href="#cb46-19" tabindex="-1"></a>  }</span>
<span id="cb46-20"><a href="#cb46-20" tabindex="-1"></a>  </span>
<span id="cb46-21"><a href="#cb46-21" tabindex="-1"></a>  <span class="fu">integrate</span>(g_1,<span class="dv">1</span>,<span class="cn">Inf</span>)<span class="sc">$</span>value</span></code></pre></div>
<pre><code>## [1] 0.2699181</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>  <span class="fu">integrate</span>(g_2,<span class="dv">1</span>,<span class="cn">Inf</span>)<span class="sc">$</span>value</span></code></pre></div>
<pre><code>## [1] 0.2517058</code></pre>
<p>By calculating <span class="math inline">\(\int_1^\infty
\frac{g^2(x)}{f(x)} dx\)</span>, we find that using <span class="math inline">\(f_2(x)\)</span> as the importance sampling density
function results in a smaller variance of 0.2517058.</p>
</div>
<div id="homework-3.3" class="section level3">
<h3>homework 3.3</h3>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[
\int_1^{\infty} \frac{x^2}{\sqrt{2 \pi}} e^{-x^2 / 2} d x
\]</span> by importance sampling.</p>
</div>
<div id="answer-3.3" class="section level3">
<h3>answer 3.3</h3>
<p>Based on the results from Question 2, we use <span class="math inline">\(f_2(x)=\frac{e^{1/2}\times
e^{-\frac{x}{2}}}{2}\)</span> for <span class="math inline">\(x&gt;1\)</span> as the density function, with its
distribution function being <span class="math inline">\(F_2(x)=1-e^{\frac{1-x}{2}}\)</span>. We construct
random variables that follow the density function <span class="math inline">\(f_2(x)\)</span> using the inverse transform
method. Let <span class="math inline">\(U\sim U(0,1/2)\)</span> and set
<span class="math inline">\(1-e^{\frac{1-X}{2}}=u\)</span>, then <span class="math inline">\(X=1-2\log(1-U)\)</span>, thus <span class="math inline">\(X&gt;1\)</span>. The following is the Monte Carlo
estimation process:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(B)</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="dv">1-2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">g</span>(X)<span class="sc">/</span><span class="fu">f_2</span>(X))</span></code></pre></div>
<pre><code>## [1] 0.4006491</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>  <span class="fu">integrate</span>(g,<span class="dv">1</span>,<span class="cn">Inf</span>)<span class="sc">$</span>value</span></code></pre></div>
<pre><code>## [1] 0.400626</code></pre>
<p>The Monte Carlo method gives an integral estimate of 0.4007113, which
is very close to the true integral value of 0.400626 obtained through
numerical computation using the integrate function.</p>
</div>
<div id="homework-3.4" class="section level3">
<h3>homework 3.4</h3>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10. In Example 5.10, our
best result was obtained with the importance function <span class="math inline">\(f_3(x)=e^{-x} /\left(1-e^{-1}\right),
0&lt;x&lt;1\)</span>. From 10,000 replicates, we obtained the estimate
<span class="math inline">\(\hat{\theta}=0.5257801\)</span> with an
estimated standard error of 0.0970314. Now divide the interval <span class="math inline">\((0,1)\)</span> into five subintervals, <span class="math inline">\((j / 5,(j+1) / 5), j=0,1, \ldots, 4\)</span>.</p>
</div>
<div id="answer-3.4" class="section level3">
<h3>answer 3.4</h3>
<p>The original function is <span class="math inline">\(g(x)=\frac{e^{-x}}{1+x^2}\)</span>. According to
the task, we use <span class="math inline">\(f(x)=\frac{e^{-x}}{1-e^{-1}}\)</span>, and the
interval is divided into <span class="math inline">\((j / 5,(j+1) / 5),
j=0,1, \ldots, 4\)</span>, with interval endpoints denoted as <span class="math inline">\({a_i,i=0,1,2,\dots,5}\)</span>. We need to
estimate five parameters:</p>
<p><span class="math display">\[
\theta_j=\int_{a_{j-1}}^{a_j} g(x) d x, \quad j=1, \ldots, k.
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
f_j(x)=f_{X \mid I_j}\left(x \mid I_j\right) &amp; =\frac{f\left(x,
a_{j-1} \leq x&lt;a_j\right)}{P\left(a_{j-1} \leq x&lt;a_j\right)} \\
&amp; =\frac{f(x)}{\int_{a_{j-1}}^{a_j}f(x)dx}, \quad a_{j-1} \leq
x&lt;a_j
\end{aligned}
\]</span></p>
<p>On the five intervals, the respective distribution functions are
<span class="math inline">\(F_i(x)\)</span>, where <span class="math inline">\(\frac{i}{5} \leq x
&lt;\frac{i+1}{5},i=0,1,2,3,4\)</span>. The variance estimator is <span class="math inline">\(\operatorname{Var}\left(\hat{\theta}^{S
I}\right)=\operatorname{Var}\left(\sum_{j=1}^k
\hat{\theta}j\right)=\sum{j=1}^k \operatorname{Var(
\hat{\theta}_j)}\)</span>, where <span class="math inline">\(\sigma_j^2=\operatorname{Var}\left(g_j(X) /
f_j(X)\right)\)</span>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>  hattheta <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="dv">5</span>)</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  vartheta <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="dv">5</span>)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>  m <span class="ot">&lt;-</span> M<span class="sc">/</span>k</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(m)</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  </span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>  }</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  </span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>  }</span>
<span id="cb54-16"><a href="#cb54-16" tabindex="-1"></a>  </span>
<span id="cb54-17"><a href="#cb54-17" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb54-18"><a href="#cb54-18" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb54-19"><a href="#cb54-19" tabindex="-1"></a>    f0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb54-20"><a href="#cb54-20" tabindex="-1"></a>      fi0 <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f,a[i],a[i<span class="sc">+</span><span class="dv">1</span>])<span class="sc">$</span>value</span>
<span id="cb54-21"><a href="#cb54-21" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">f</span>(x)<span class="sc">/</span>fi0)</span>
<span id="cb54-22"><a href="#cb54-22" tabindex="-1"></a>    }</span>
<span id="cb54-23"><a href="#cb54-23" tabindex="-1"></a>    f0x <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb54-24"><a href="#cb54-24" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">integrate</span>(f0,a[i],x)<span class="sc">$</span>value)</span>
<span id="cb54-25"><a href="#cb54-25" tabindex="-1"></a>    }</span>
<span id="cb54-26"><a href="#cb54-26" tabindex="-1"></a>    fi <span class="ot">&lt;-</span> <span class="cf">function</span>(u,x){</span>
<span id="cb54-27"><a href="#cb54-27" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">f0x</span>(x)<span class="sc">-</span>u)</span>
<span id="cb54-28"><a href="#cb54-28" tabindex="-1"></a>    }</span>
<span id="cb54-29"><a href="#cb54-29" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb54-30"><a href="#cb54-30" tabindex="-1"></a>      X[j] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(fi,<span class="fu">c</span>(a[i],a[i<span class="sc">+</span><span class="dv">1</span>]),<span class="at">u=</span>U[j])<span class="sc">$</span>root</span>
<span id="cb54-31"><a href="#cb54-31" tabindex="-1"></a>      X[j] <span class="ot">&lt;-</span> <span class="fu">g</span>(X[j])<span class="sc">/</span><span class="fu">f0</span>(X[j])</span>
<span id="cb54-32"><a href="#cb54-32" tabindex="-1"></a>    }</span>
<span id="cb54-33"><a href="#cb54-33" tabindex="-1"></a>    hattheta[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb54-34"><a href="#cb54-34" tabindex="-1"></a>    vartheta[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(X)</span>
<span id="cb54-35"><a href="#cb54-35" tabindex="-1"></a>  }</span>
<span id="cb54-36"><a href="#cb54-36" tabindex="-1"></a>  <span class="fu">sum</span>(hattheta)</span></code></pre></div>
<pre><code>## [1] 0.5249997</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>(vartheta))</span></code></pre></div>
<pre><code>## [1] 0.007888417</code></pre>
<p>Since the expression for <span class="math inline">\(f_j(x)\)</span>
is somewhat complex, we do not provide a specific expression for
generating the distribution in the inverse transform method, but rather
use the root-finding function uniroot to determine <span class="math inline">\(X\)</span> such that <span class="math inline">\(F_i(X) = U\)</span>. The estimate of <span class="math inline">\(\theta\)</span> obtained is 0.5246747, with a
standard deviation of 0.007902386. The estimate is close to the previous
method, and the standard deviation is significantly smaller than the
previous method’s standard deviation of 0.0970314.</p>
</div>
<div id="homework-3.5" class="section level3">
<h3>homework 3.5</h3>
<p>Suppose a <span class="math inline">\(95 \%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean,
but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95 .
Use a Monte Carlo experiment to estimate the coverage probability of the
<span class="math inline">\(t\)</span>-interval for random samples of
<span class="math inline">\(\chi^2(2)\)</span> data with sample size
<span class="math inline">\(n=20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation
results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to
departures from normality than the interval for variance.)</p>
</div>
<div id="answer-3.5" class="section level3">
<h3>answer 3.5</h3>
<p>For data from a chi-squared distribution with 2 degrees of freedom,
we calculate the probability that the true chi-squared variance of 4
falls within the variance interval, similar to Example 6.4.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  </span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>    UCL <span class="ot">&lt;-</span> (n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>    <span class="cf">if</span>(UCL<span class="sc">&gt;</span><span class="dv">4</span>){</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>      s <span class="ot">&lt;-</span> s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>    }</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>  }</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>  s<span class="sc">/</span>B</span></code></pre></div>
<pre><code>## [1] 0.783746</code></pre>
<p>In the case of a normal distribution, we can use the t-interval to
estimate the mean, i.e., <span class="math inline">\(\frac{\sqrt{n}(\bar{X}-\mu)}{S} \sim
t_{n-1}\)</span>, and the 95% confidence upper limit of the t-interval
for <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\bar{X} + \frac{t_{n-1}(0.95)\times
S}{\sqrt{n}}\)</span>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>  </span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>    UCL <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(<span class="fl">0.95</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>    <span class="cf">if</span>(UCL<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>      s <span class="ot">&lt;-</span> s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>    }</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  }</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>  s<span class="sc">/</span>B</span></code></pre></div>
<pre><code>## [1] 0.949778</code></pre>
<p>In the case of random variables following a normal distribution, the
probability that the true mean <span class="math inline">\(\mu =
0\)</span> falls within the t-interval is very close to 95%, which is
reasonable. Next, we consider the chi-squared distribution case,
calculating the probability that the true mean of 2 falls within the
t-interval.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  </span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>    UCL <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(<span class="fl">0.95</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>    <span class="cf">if</span>(UCL<span class="sc">&gt;</span><span class="dv">2</span>){</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>      s <span class="ot">&lt;-</span> s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>    }</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>  }</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>  s<span class="sc">/</span>B</span></code></pre></div>
<pre><code>## [1] 0.890817</code></pre>
<p>We find that in the non-normal case, for the variance interval, the
probability of the true variance falling within it is only about 0.78,
while for the t-interval estimating the mean, the probability of the
true mean falling within it is about 0.89. It indicates that for
distributions deviating from normality, the t-interval is likely more
robust than the variance interval.</p>
</div>
<div id="homework-3.6" class="section level3">
<h3>homework 3.6</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the <span class="math inline">\(t\)</span>-test is
approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is
non-normal. The <span class="math inline">\(t\)</span>-test is robust to
mild departures from normality. Discuss the simulation results for the
cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform <span class="math inline">\((0,2)\)</span>, and (iii) Exponential(rate=1). In
each case, test <span class="math inline">\(H_0: \mu=\mu_0\)</span> vs
<span class="math inline">\(H_0: \mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and
Exponential(1), respectively.</p>
</div>
<div id="answer-3.6" class="section level3">
<h3>answer 3.6</h3>
<p>We set <span class="math inline">\(\alpha=0.05\)</span> and consider
a two-tailed test, similar to Question 5. The confidence interval upper
bound is <span class="math inline">\(\bar{X} + \frac{t_{n-1}(0.975)
\times S}{\sqrt{n}}\)</span>. Below, we check whether the t-interval is
robust enough for these non-normal distributions.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>  <span class="do">##卡方分布</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>  </span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>    UCL <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>    UCR <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a>    <span class="cf">if</span>(UCL<span class="sc">&lt;</span><span class="dv">1</span> <span class="sc">|</span> UCR<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>      s <span class="ot">&lt;-</span> s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>    }</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>  }</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>  s<span class="sc">/</span>B</span></code></pre></div>
<pre><code>## [1] 0.107508</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>  <span class="do">##均匀分布</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>  </span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>    UCL <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>    UCR <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>    <span class="cf">if</span>(UCL<span class="sc">&lt;</span><span class="dv">1</span> <span class="sc">|</span> UCR<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>      s <span class="ot">&lt;-</span> s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>    }</span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>  }</span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>  s<span class="sc">/</span>B</span></code></pre></div>
<pre><code>## [1] 0.051497</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>  <span class="do">##指数分布</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>  </span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>    UCL <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>    UCR <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>    <span class="cf">if</span>(UCL<span class="sc">&lt;</span><span class="dv">1</span> <span class="sc">|</span> UCR<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>      s <span class="ot">&lt;-</span> s<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>    }</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>  }</span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>  s<span class="sc">/</span>B</span></code></pre></div>
<pre><code>## [1] 0.080829</code></pre>
<p>For the three distributions, the Type I error rates are 0.107508,
0.051497, and 0.080829, respectively, which are close to the
significance level <span class="math inline">\(\alpha=0.05\)</span>.
Thus, we can conclude that the t-test is robust to slight deviations
from the normal distribution.</p>
</div>
</div>
<div id="homework-4" class="section level2">
<h2>homework 4</h2>
<div id="homework-4.1" class="section level3">
<h3>homework 4.1</h3>
<p>Consider 1000 hypotheses, where the first 95% are true null
hypotheses, and the last 5% are false null hypotheses. Under the true
null hypotheses, p-values follow a U(0,1) distribution, while under the
false null hypotheses, they follow a Beta(0.1,1) distribution, which can
be generated using the rbeta function. For the independently generated
1000 p-values, apply Bonferroni and BH (Benjamini-Hochberg) corrections
using the p.adjust function, then compare the adjusted p-values to <span class="math inline">\(\alpha = 0.01\)</span> to determine whether to
reject the null hypothesis. Based on 1000 simulations, estimate the
FWER, FDR, and TPR, and output the results in a table.</p>
</div>
<div id="answer-4.1" class="section level3">
<h3>answer 4.1</h3>
<p>For the first 95% of hypotheses, where null hypotheses are true, 950
p-values follow a U(0,1) distribution, and for the last 5%, where
alternative hypotheses are true, 50 p-values follow a Beta(0.1,1)
distribution. FWER represents the probability of at least one false
positive when null hypotheses are true. FDR represents the ratio of the
number of true null hypotheses rejected to the total number of
hypotheses rejected. TPR represents the proportion of correctly rejected
null hypotheses when alternative hypotheses are true.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(m)</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>  </span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>  p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(m1)</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>  p[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(m2,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>  pbon <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  pbh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&quot;BH&quot;</span>)</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>  <span class="fu">sum</span>(pbon<span class="sc">&lt;</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 16</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>  <span class="fu">sum</span>(pbh<span class="sc">&lt;</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 26</code></pre>
<p>For this multiple testing scenario, regardless of whether Bonferroni
or BH correction is used, hypotheses with p-values less than the
significance level <span class="math inline">\(\alpha = 0.1\)</span>
were observed, thus rejecting the null hypothesis for both
corrections.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="dv">950</span></span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>  </span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(m)</span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>  FWER <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>  FWER0 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  FDR <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>  FDR0 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>  TPR <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>  TPR0 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>  </span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb74-15"><a href="#cb74-15" tabindex="-1"></a>    <span class="fu">set.seed</span>(i)</span>
<span id="cb74-16"><a href="#cb74-16" tabindex="-1"></a>    p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(m1)</span>
<span id="cb74-17"><a href="#cb74-17" tabindex="-1"></a>    p[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(m2,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb74-18"><a href="#cb74-18" tabindex="-1"></a>    pbon <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb74-19"><a href="#cb74-19" tabindex="-1"></a>    pbh <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&quot;BH&quot;</span>)</span>
<span id="cb74-20"><a href="#cb74-20" tabindex="-1"></a>    </span>
<span id="cb74-21"><a href="#cb74-21" tabindex="-1"></a>    FWER[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(pbon[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">==</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb74-22"><a href="#cb74-22" tabindex="-1"></a>    FWER0[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">sum</span>(pbh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">==</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb74-23"><a href="#cb74-23" tabindex="-1"></a>    </span>
<span id="cb74-24"><a href="#cb74-24" tabindex="-1"></a>    FDR[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">intersect</span>(<span class="fu">which</span>(pbon<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>))<span class="sc">/</span><span class="fu">sum</span>(pbon<span class="sc">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb74-25"><a href="#cb74-25" tabindex="-1"></a>    FDR0[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">intersect</span>(<span class="fu">which</span>(pbh<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>))<span class="sc">/</span><span class="fu">sum</span>(pbh<span class="sc">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb74-26"><a href="#cb74-26" tabindex="-1"></a>    </span>
<span id="cb74-27"><a href="#cb74-27" tabindex="-1"></a>    TPR[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">intersect</span>(<span class="fu">which</span>(pbon<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>))<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb74-28"><a href="#cb74-28" tabindex="-1"></a>    TPR0[i] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">intersect</span>(<span class="fu">which</span>(pbh<span class="sc">&lt;</span><span class="fl">0.1</span>),<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>))<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb74-29"><a href="#cb74-29" tabindex="-1"></a>  }</span>
<span id="cb74-30"><a href="#cb74-30" tabindex="-1"></a>  <span class="fu">mean</span>(FWER);<span class="fu">mean</span>(FWER0)</span></code></pre></div>
<pre><code>## [1] 0.083</code></pre>
<pre><code>## [1] 0.932</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>  <span class="fu">mean</span>(FDR);<span class="fu">mean</span>(FDR0)</span></code></pre></div>
<pre><code>## [1] 0.004251612</code></pre>
<pre><code>## [1] 0.09534609</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>  <span class="fu">mean</span>(TPR);<span class="fu">mean</span>(TPR0)</span></code></pre></div>
<pre><code>## [1] 0.3979</code></pre>
<pre><code>## [1] 0.56506</code></pre>
<p>For the first Bonferroni correction, the method parameter in the
p.adjust function is set to bonferroni, i.e., <span class="math inline">\(p_i \leftarrow \min{mp_i, 1}\)</span>, where <span class="math inline">\(m\)</span> is the number of hypotheses in multiple
testing. For the second BH correction, the method parameter is set to
BH, i.e., <span class="math inline">\(p_i \leftarrow \min{mp_i/i,
1}\)</span>. Based on 1000 simulations, the estimates for FWER, FDR, and
TPR are as shown in the following table:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>FWER</th>
<th>FDR</th>
<th>TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>bonferroni校正</td>
<td>0.083</td>
<td>0.004</td>
<td>0.3979</td>
</tr>
<tr class="even">
<td>BH校正</td>
<td>0.932</td>
<td>0.095</td>
<td>0.565</td>
</tr>
</tbody>
</table>
</div>
<div id="homework-4.2" class="section level3">
<h3>homework 4.2</h3>
<p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat{\lambda}=1 / \bar{X}\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat{\lambda}\)</span> is <span class="math inline">\(\lambda n /(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda /(n-1)\)</span>. The
standard error <span class="math inline">\(\hat{\lambda}\)</span> is
<span class="math inline">\(\lambda n /[(n-1) \sqrt{n-2}]\)</span>.
Conduct a simulation study to verify the performance of the bootstrap
method. The true value of <span class="math inline">\(\lambda=2\)</span>. The sample size <span class="math inline">\(n=5,10,20\)</span>. The number of bootstrap
replicates <span class="math inline">\(B=1000\)</span>. The simulations
are repeated for <span class="math inline">\(m=1000\)</span> times.</p>
<p>Compare the mean bootstrap bias and bootstrap standard error with the
theoretical ones. Comment on the results.</p>
</div>
<div id="answer-4.2" class="section level3">
<h3>answer 4.2</h3>
<p>We conduct a simulation study using the bootstrap method to estimate
the mean and variance, verifying its consistency with theoretical
results. We repeat the simulation 1000 times to obtain the average
bootstrap bias and standard error.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>  bootstrapexp <span class="ot">&lt;-</span> <span class="cf">function</span>(n,lambda,B,M){</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,lambda)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>    lambdaresult <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>    seresult <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(M)</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>    </span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>      lambdahat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>      sehat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>      <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>        xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x,n,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>        lambdahat[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>      }</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>      seresult[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambdahat)</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a>      lambdaresult[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambdahat)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a>    }</span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>    bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambdaresult)</span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">mean</span>(seresult)</span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">bias=</span>bias,<span class="at">se=</span>se))</span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a>  }</span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>  </span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb83-24"><a href="#cb83-24" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb83-25"><a href="#cb83-25" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb83-26"><a href="#cb83-26" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb83-27"><a href="#cb83-27" tabindex="-1"></a>  n3 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb83-28"><a href="#cb83-28" tabindex="-1"></a>  </span>
<span id="cb83-29"><a href="#cb83-29" tabindex="-1"></a>  <span class="fu">bootstrapexp</span>(n1,lambda,B,M)</span></code></pre></div>
<pre><code>## $bias
## [1] 0.5489828
## 
## $se
## [1] 1.893183</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>  <span class="fu">bootstrapexp</span>(n2,lambda,B,M)</span></code></pre></div>
<pre><code>## $bias
## [1] 0.2326631
## 
## $se
## [1] 0.8599797</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>  <span class="fu">bootstrapexp</span>(n3,lambda,B,M)</span></code></pre></div>
<pre><code>## $bias
## [1] 0.07819078
## 
## $se
## [1] 0.4001098</code></pre>
<p>The theoretical bias and standard error are <span class="math inline">\(\frac{\lambda}{n-1} = 0.5, 0.222, 0.105\)</span>
and <span class="math inline">\(\frac{\lambda n}{[(n-1) \sqrt{n-2}]} =
1.443, 0.786, 0.496\)</span>, respectively. We find that the results
from bootstrap simulations are in close agreement with these theoretical
properties.</p>
</div>
<div id="homework-4.3" class="section level3">
<h3>homework 4.3</h3>
Obtain a bootstrap <span class="math inline">\(\mathrm{t}\)</span>
confidence interval estimate for the correlation statistic in Example
7.2 (law data in bootstrap).The data frame contains LSAT (average score
on law school admission test score) and GPA (average undergraduate
grade-point average) for 15 law schools.
</div>
<div id="answer-4.3" class="section level3">
<h3>answer 4.3</h3>
<p>We assume the construction of a confidence interval at a confidence
level of <span class="math inline">\(1-\alpha\)</span>, where <span class="math inline">\(\alpha=0.05\)</span>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">576</span>,<span class="dv">635</span>,<span class="dv">558</span>,<span class="dv">578</span>,<span class="dv">666</span>,<span class="dv">580</span>,<span class="dv">555</span>,<span class="dv">661</span>,<span class="dv">651</span>,<span class="dv">605</span>,<span class="dv">653</span>,<span class="dv">575</span>,<span class="dv">545</span>,<span class="dv">572</span>,<span class="dv">594</span>)</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">339</span>,<span class="dv">330</span>,<span class="dv">281</span>,<span class="dv">303</span>,<span class="dv">344</span>,<span class="dv">307</span>,<span class="dv">300</span>,<span class="dv">343</span>,<span class="dv">336</span>,<span class="dv">313</span>,<span class="dv">312</span>,<span class="dv">274</span>,<span class="dv">276</span>,<span class="dv">288</span>,<span class="dv">296</span>)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  </span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>  bootse <span class="ot">&lt;-</span> <span class="cf">function</span>(LSAT,GPA,R){</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">length</span>(LSAT)</span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>    th <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(R)</span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>      A <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>      <span class="co">#B &lt;- sample(1:m, size = m, replace = TRUE)</span></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>      th[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(LSAT[A],GPA[A])</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>      <span class="co">#th[i] &lt;- cor(LSAT[A],GPA[B])</span></span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>    }</span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sd</span>(th))</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>  }</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>  </span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a>  R <span class="ot">&lt;-</span> t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>  Rsd <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a>  LSAT <span class="ot">&lt;-</span> GPA <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a>    LSAT <span class="ot">&lt;-</span> x[i]</span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a>    GPA <span class="ot">&lt;-</span> y[i]</span>
<span id="cb89-27"><a href="#cb89-27" tabindex="-1"></a>    R[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(LSAT, GPA)</span>
<span id="cb89-28"><a href="#cb89-28" tabindex="-1"></a>    Rsd[b] <span class="ot">&lt;-</span> <span class="fu">bootse</span>(LSAT,GPA,<span class="at">R =</span> <span class="dv">100</span>)</span>
<span id="cb89-29"><a href="#cb89-29" tabindex="-1"></a>  }</span>
<span id="cb89-30"><a href="#cb89-30" tabindex="-1"></a>  t <span class="ot">&lt;-</span> (R<span class="sc">-</span>rhat)<span class="sc">/</span>Rsd</span>
<span id="cb89-31"><a href="#cb89-31" tabindex="-1"></a>  rhat<span class="sc">-</span><span class="fu">quantile</span>(t,<span class="fl">0.025</span>)<span class="sc">*</span><span class="fu">sd</span>(R)</span></code></pre></div>
<pre><code>##      2.5% 
## 0.9902184</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>  rhat<span class="sc">-</span><span class="fu">quantile</span>(t,<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sd</span>(R)</span></code></pre></div>
<pre><code>##      97.5% 
## -0.2555618</code></pre>
<p>Therefore, the <span class="math inline">\(1-\alpha\)</span>
confidence interval for the correlation coefficient in the original
Example 7.2 is <span class="math inline">\([0.6804,
0.9304]\)</span>.</p>
</div>
</div>
<div id="homework-5" class="section level2">
<h2>homework 5</h2>
<div id="homework-5.1" class="section level3">
<h3>homework 5.1</h3>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95%\)</span> bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1 /
\lambda\)</span> by the standard normal, basic, percentile, and BCa
methods. Compare the intervals and explain why they may differ.</p>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
air conditioning equipment [63, Example 1.1]:</p>
<p><span class="math display">\[
3,5,7,18,43,85,91,98,100,130,230,487 .
\]</span></p>
<p>Assume that the times between failures follow an exponential model
<span class="math inline">\(\operatorname{Exp}(\lambda)\)</span>.</p>
</div>
<div id="answer-5.1" class="section level3">
<h3>answer 5.1</h3>
<p>We use the boot and boot.ci functions from the R package library to
calculate the corresponding normal, basic, and percentile bootstrap
confidence intervals. The MLE for the parameter <span class="math inline">\(\frac{1}{\lambda}\)</span> is <span class="math inline">\(\bar{X}\)</span>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>  <span class="fu">mean</span>(data)</span></code></pre></div>
<pre><code>## [1] 108.0833</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>  lambda.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, ind) {</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>    <span class="fu">mean</span>(data[ind])</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  }</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, <span class="at">statistic =</span> lambda.boot, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  <span class="fu">boot.ci</span>(boot.obj, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 37.9, 181.2 )   ( 31.1, 168.6 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.6, 185.1 )   ( 61.1, 225.1 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>All four intervals cover the sample mean <span class="math inline">\(\bar{X} = 108\)</span>. The Normal, Basic, and
Percentile confidence intervals are similar in length, around 145, while
the BCa interval is slightly longer, around 170. We observe that the
regions covered by these four intervals vary. The Basic interval, with
the smallest range of <span class="math inline">\((27.6,
170.6)\)</span>, suggests lower estimated values, followed by the Normal
interval, then the Percentile interval, and finally the BCa interval,
which indicates higher estimated values at <span class="math inline">\((57.8, 226.9)\)</span>. We note that there is a
noticeable deviation between the Normal and BCa intervals, which might
be due to the sampling distribution of the related statistics not
closely resembling a normal distribution.</p>
</div>
<div id="homework-5.2" class="section level3">
<h3>homework 5.2</h3>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on
88 students who took examinations in five subjects [84, Table 7.1],
[188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed
book and the last three tests (algebra, analysis, statistics) were open
book. Each row of the data frame is a set of scores <span class="math inline">\(\left(x_{i 1}, \ldots, x_{i 5}\right)\)</span> for
the <span class="math inline">\(i^{t h}\)</span> student.</p>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following
example [84, Ch. 7]. The five-dimensional scores data have a <span class="math inline">\(5 \times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. In
principal components analysis, <span class="math display">\[
\theta=\frac{\lambda_1}{\sum_{j=1}^5 \lambda_j}
\]</span> measures the proportion of variance explained by the first
principal component. Let <span class="math inline">\(\hat{\lambda}_1&gt;\cdots&gt;\hat{\lambda}_5\)</span>
be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,
where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of
<span class="math inline">\(\Sigma\)</span>. Compute the sample estimate
<span class="math display">\[
\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^5 \hat{\lambda}_j}
\]</span></p>
<p>of <span class="math inline">\(\theta\)</span>. Refer to Exercise
7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-5.2" class="section level3">
<h3>answer 5.2</h3>
<p>The MLE for the covariance matrix is <span class="math inline">\(\hat{\Sigma}=\hat{\Sigma}(x_1,x_2,\dots,x_n)=\frac{1}{n}
\sum_{t=1}^n\left(x_t-\bar{x}\right)\left(x_t-\bar{x}\right)^T\)</span>,
where the sample <span class="math inline">\(x=(x_1,x_2,\dots,x_n)\)</span>. We estimate using
the jackknife method, where <span class="math inline">\(\hat{\Sigma}{(i)}=\hat{\Sigma}\left(x_1, \dots,
x{i-1}, x_{i+1}, \dots, x_n\right)\)</span>, and the corresponding
eigenvalues are <span class="math inline">\(\hat{\lambda}{1(i)},\hat{\lambda}{2(i)},\dots,\hat{\lambda}{5(i)}\)</span>.
The estimated value of the parameter to be estimated is <span class="math inline">\(\hat{\theta}{(i)}=\frac{\hat{\lambda}{1(i)}}{\sum{j=1}^5\hat{\lambda}_{j(i)}}\)</span>.
The bias estimate is <span class="math display">\[
(n-1)\left(\overline{\hat{\theta}}_{(\cdot)}-\hat{\theta}\right).
\]</span></p>
<p>The standard error estimate is <span class="math display">\[
\widehat{\operatorname{var}}(\hat{\theta})=\frac{n-1}{n}
\sum_{i=1}^n\left(\hat{\theta}_{(i)}-\overline{\hat{\theta}}_{(\cdot)}\right)^2.
\]</span></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>  <span class="fu">data</span>(scor, <span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>  thetaeigenvalue <span class="ot">&lt;-</span> <span class="cf">function</span>(dat,ind){</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>    data <span class="ot">&lt;-</span> dat[ind,]</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>    sigma <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(data))</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">max</span>(sigma<span class="sc">$</span>val)<span class="sc">/</span><span class="fu">sum</span>(sigma<span class="sc">$</span>val))</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>  }</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>  theta.hat <span class="ot">&lt;-</span> <span class="fu">thetaeigenvalue</span>(scor,<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>  theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>    theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">thetaeigenvalue</span>(scor,<span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n,i))</span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>  }</span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a>  bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb97-14"><a href="#cb97-14" tabindex="-1"></a>  se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb97-15"><a href="#cb97-15" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##    0.6191    0.0011    0.0496</code></pre>
<p>Upon observation, using the jackknife method, we estimate the bias of
the parameter <span class="math inline">\(\theta\)</span> as 0.0011 and
the standard error as 0.0496.</p>
</div>
<div id="homework-5.3" class="section level3">
<h3>homework 5.3</h3>
<p>In Example 7.18, leave-one-out (<span class="math inline">\(n\)</span>-fold) cross-validation was used to
select the best-fitting model. Use leave-two-out cross-validation to
compare the models.</p>
</div>
<div id="answer-5.3" class="section level3">
<h3>answer 5.3</h3>
<p>The leave-two-out cross-validation method requires holding back two
points as the test set each time, yielding <span class="math inline">\(\binom{n}{2}\)</span> prediction errors, each
containing the residuals for the two points in the test set.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>  <span class="fu">attach</span>(ironslag)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) </span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>      <span class="cf">if</span>(j <span class="sc">&lt;=</span> i){</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>        c[[k]] <span class="ot">&lt;-</span> <span class="fu">c</span>(i,j)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>        k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>      }</span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>    }</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>  }</span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">choose</span>(n,<span class="dv">2</span>)</span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb99-16"><a href="#cb99-16" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>c[[k]]]</span>
<span id="cb99-17"><a href="#cb99-17" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>c[[k]]]</span>
<span id="cb99-18"><a href="#cb99-18" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb99-19"><a href="#cb99-19" tabindex="-1"></a>    yhat1_1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">1</span>]]</span>
<span id="cb99-20"><a href="#cb99-20" tabindex="-1"></a>    yhat1_2 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">2</span>]]</span>
<span id="cb99-21"><a href="#cb99-21" tabindex="-1"></a>    e1[k] <span class="ot">&lt;-</span> (magnetic[c[[k]][<span class="dv">1</span>]]<span class="sc">-</span>yhat1_1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[c[[k]][<span class="dv">2</span>]]<span class="sc">-</span>yhat1_2)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb99-22"><a href="#cb99-22" tabindex="-1"></a>    </span>
<span id="cb99-23"><a href="#cb99-23" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb99-24"><a href="#cb99-24" tabindex="-1"></a>    yhat2_1 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">1</span>]] <span class="sc">+</span></span>
<span id="cb99-25"><a href="#cb99-25" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">1</span>]]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb99-26"><a href="#cb99-26" tabindex="-1"></a>    yhat2_2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">2</span>]] <span class="sc">+</span></span>
<span id="cb99-27"><a href="#cb99-27" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">2</span>]]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb99-28"><a href="#cb99-28" tabindex="-1"></a>    e2[k] <span class="ot">&lt;-</span> (magnetic[c[[k]][<span class="dv">1</span>]] <span class="sc">-</span> yhat2_1)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (magnetic[c[[k]][<span class="dv">2</span>]] <span class="sc">-</span> yhat2_2)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb99-29"><a href="#cb99-29" tabindex="-1"></a>    </span>
<span id="cb99-30"><a href="#cb99-30" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb99-31"><a href="#cb99-31" tabindex="-1"></a>    logyhat3_1 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">1</span>]]</span>
<span id="cb99-32"><a href="#cb99-32" tabindex="-1"></a>    yhat3_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3_1)</span>
<span id="cb99-33"><a href="#cb99-33" tabindex="-1"></a>    logyhat3_2 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[c[[k]][<span class="dv">2</span>]]</span>
<span id="cb99-34"><a href="#cb99-34" tabindex="-1"></a>    yhat3_2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3_2)</span>
<span id="cb99-35"><a href="#cb99-35" tabindex="-1"></a>    e3[k] <span class="ot">&lt;-</span> (magnetic[c[[k]][<span class="dv">1</span>]] <span class="sc">-</span> yhat3_1)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(magnetic[c[[k]][<span class="dv">2</span>]] <span class="sc">-</span> yhat3_2)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb99-36"><a href="#cb99-36" tabindex="-1"></a>    </span>
<span id="cb99-37"><a href="#cb99-37" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb99-38"><a href="#cb99-38" tabindex="-1"></a>    logyhat4_1 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[c[[k]][<span class="dv">1</span>]])</span>
<span id="cb99-39"><a href="#cb99-39" tabindex="-1"></a>    yhat4_1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4_1)</span>
<span id="cb99-40"><a href="#cb99-40" tabindex="-1"></a>    logyhat4_2 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[c[[k]][<span class="dv">2</span>]])</span>
<span id="cb99-41"><a href="#cb99-41" tabindex="-1"></a>    yhat4_2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4_2)</span>
<span id="cb99-42"><a href="#cb99-42" tabindex="-1"></a>    e4[k] <span class="ot">&lt;-</span> (magnetic[c[[k]][<span class="dv">1</span>]] <span class="sc">-</span> yhat4_1)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(magnetic[c[[k]][<span class="dv">2</span>]] <span class="sc">-</span> yhat4_2)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb99-43"><a href="#cb99-43" tabindex="-1"></a>  }</span>
<span id="cb99-44"><a href="#cb99-44" tabindex="-1"></a>  </span>
<span id="cb99-45"><a href="#cb99-45" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 36.79691 32.89097 33.86880 37.92668</code></pre>
<p>Observing the prediction error results, we find that Model 2, the
quadratic model, fits the dataset best. This is consistent with the
optimal fitting model obtained through leave-one-out
cross-validation.</p>
</div>
</div>
<div id="homework-6" class="section level2">
<h2>homework 6</h2>
<div id="homework-6.1" class="section level3">
<h3>homework 6.1</h3>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="answer-6.1" class="section level3">
<h3>answer 6.1</h3>
<p>Assume that the target distribution <span class="math inline">\(f\)</span> has a continuous support set. Let <span class="math inline">\(G\)</span> be a transition distribution function
such that for each <span class="math inline">\(s\)</span>, <span class="math inline">\(G(s,\cdot)\)</span> has a transition kernel
density <span class="math inline">\(g(\cdot|s)\)</span>. After drawing a
sample <span class="math inline">\(r\)</span> from <span class="math inline">\(G(s,\cdot)\)</span>, the acceptance probability is
calculated as: <span class="math display">\[
\alpha(s, r)=\min \left\{\frac{f(r) g(s|r)}{f(s) g(r|s)}, 1\right\}.
\]</span></p>
<p>This is valid for all <span class="math inline">\((s,r)\)</span>
where <span class="math inline">\(f(s)g(r|s)&gt;0\)</span>. Thus, the
Markov chain transition kernel is: <span class="math display">\[
K(r,s)=g(r|s)\alpha(s,r)=g(r|s)\min \left\{\frac{f(r) g(s|r)}{f(s)
g(r|s)}, 1\right\}.
\]</span></p>
<p>Where</p>
<span class="math display">\[\begin{aligned}
K(r,s)f(s) &amp;= f(s)g(r|s)\min \left\{\frac{f(r) g(s|r)}{f(s) g(r|s)},
1\right\}\nonumber\\
&amp;=\left\{
\begin{array}{rcl}
f(r)g(s|r),\quad \frac{f(r) g(s|r)}{f(s) g(r|s)}&lt;1,\\
f(s)g(r|s),\quad \frac{f(r) g(s|r)}{f(s) g(r|s)} \geq 1,
\end{array}\right.\nonumber\\
&amp;= f(r)g(s|r)\min \left\{1,\frac{f(s) g(r|s)}{f(r)
g(s|r)}\right\}\nonumber\\
&amp;= K(s,r)f(r),r \neq s.\nonumber
\end{aligned}\]</span>
<p>For a given <span class="math inline">\(r\)</span>, we define <span class="math inline">\(K(r,r)\)</span> such that <span class="math inline">\(\int K(s,r)ds=1\)</span>. Thus, <span class="math inline">\(K(r,s)f(s)=K(s,r)f(r)\)</span> holds true when
<span class="math inline">\(r = s\)</span>. Integrating both sides of
the detailed balance equation with respect to <span class="math inline">\(s\)</span> yields: <span class="math display">\[\int K(r,s)f(s)ds=\int
K(s,r)f(r)ds=f(r).\]</span></p>
<p>This implies that <span class="math inline">\(f(r)=\int
K(r,s)f(s)ds\)</span>. According to the definition of a stationary
distribution, <span class="math inline">\(f\)</span> is a stationary
distribution.</p>
</div>
<div id="homework-6.2" class="section level3">
<h3>homework 6.2</h3>
<p>Implement the Two-Sample Cramér-von Mises Test for Equal
Distributions as a Permutation Test. Apply the Test to the Data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-6.2" class="section level3">
<h3>answer 6.2</h3>
<p>We use the Cramér-von Mises statistic for the two-sample test,
represented as:</p>
<p><span class="math display">\[
W_2=\frac{m
n}{(m+n)^2}\left[\sum_{i=1}^n\left(F_n\left(x_i\right)-G_m\left(x_i\right)\right)^2+\sum_{j=1}^m\left(F_n\left(y_j\right)-G_m\left(y_j\right)\right)^2\right].
\]</span> <span class="math inline">\(F_n\)</span> is the empirical
cumulative distribution function (ecdf) of the sample <span class="math inline">\(x_1, \ldots, x_n\)</span>; <span class="math inline">\(G_m\)</span> is the ecdf of the sample <span class="math inline">\(y_1, \ldots, y_m\)</span>. Analysis for Example
8.1 is as follows:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a>  <span class="fu">attach</span>(chickwts)</span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>  <span class="fu">detach</span>(chickwts)</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) </span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a>  k <span class="ot">&lt;-</span> n<span class="sc">+</span>m</span>
<span id="cb101-10"><a href="#cb101-10" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb101-11"><a href="#cb101-11" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) </span>
<span id="cb101-12"><a href="#cb101-12" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb101-13"><a href="#cb101-13" tabindex="-1"></a>  </span>
<span id="cb101-14"><a href="#cb101-14" tabindex="-1"></a>  ecdf <span class="ot">&lt;-</span> <span class="cf">function</span>(vec,x){</span>
<span id="cb101-15"><a href="#cb101-15" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb101-16"><a href="#cb101-16" tabindex="-1"></a>    R <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(n)</span>
<span id="cb101-17"><a href="#cb101-17" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb101-18"><a href="#cb101-18" tabindex="-1"></a>      R[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(vec<span class="sc">&lt;=</span>x[i])</span>
<span id="cb101-19"><a href="#cb101-19" tabindex="-1"></a>    }</span>
<span id="cb101-20"><a href="#cb101-20" tabindex="-1"></a>    <span class="fu">return</span>(R)</span>
<span id="cb101-21"><a href="#cb101-21" tabindex="-1"></a>  }</span>
<span id="cb101-22"><a href="#cb101-22" tabindex="-1"></a>  </span>
<span id="cb101-23"><a href="#cb101-23" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="cf">function</span>(vec1,vec2,x,y){</span>
<span id="cb101-24"><a href="#cb101-24" tabindex="-1"></a>    f1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec1,x)</span>
<span id="cb101-25"><a href="#cb101-25" tabindex="-1"></a>    f2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec1,y)</span>
<span id="cb101-26"><a href="#cb101-26" tabindex="-1"></a>    g1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec2,x)</span>
<span id="cb101-27"><a href="#cb101-27" tabindex="-1"></a>    g2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec2,y)</span>
<span id="cb101-28"><a href="#cb101-28" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(f1<span class="sc">-</span>g1)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="fu">sum</span>(f2<span class="sc">-</span>g2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb101-29"><a href="#cb101-29" tabindex="-1"></a>  }</span>
<span id="cb101-30"><a href="#cb101-30" tabindex="-1"></a>  </span>
<span id="cb101-31"><a href="#cb101-31" tabindex="-1"></a>  D0 <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">W</span>(x,y,x,y)</span>
<span id="cb101-32"><a href="#cb101-32" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb101-33"><a href="#cb101-33" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">sample</span>(k, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb101-34"><a href="#cb101-34" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[K]</span>
<span id="cb101-35"><a href="#cb101-35" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>K] </span>
<span id="cb101-36"><a href="#cb101-36" tabindex="-1"></a>    D[i] <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">W</span>(x1,y1,x1,y1)</span>
<span id="cb101-37"><a href="#cb101-37" tabindex="-1"></a>  }</span>
<span id="cb101-38"><a href="#cb101-38" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb101-39"><a href="#cb101-39" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb101-40"><a href="#cb101-40" tabindex="-1"></a>  p</span></code></pre></div>
<pre><code>## [1] 0.2547453</code></pre>
<p>If we consider a significance level <span class="math inline">\(\alpha=0.05\)</span>, we do not have sufficient
evidence to reject the null hypothesis at this level, implying that the
samples <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> may be from the same distribution. The
analysis for Example 8.2 is as follows:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>  <span class="fu">attach</span>(chickwts)</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>]))</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>  <span class="fu">detach</span>(chickwts)</span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) </span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>  k <span class="ot">&lt;-</span> n<span class="sc">+</span>m</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a>  R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) </span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb103-13"><a href="#cb103-13" tabindex="-1"></a>  </span>
<span id="cb103-14"><a href="#cb103-14" tabindex="-1"></a>  ecdf <span class="ot">&lt;-</span> <span class="cf">function</span>(vec,x){</span>
<span id="cb103-15"><a href="#cb103-15" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb103-16"><a href="#cb103-16" tabindex="-1"></a>    R <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(n)</span>
<span id="cb103-17"><a href="#cb103-17" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb103-18"><a href="#cb103-18" tabindex="-1"></a>      R[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(vec<span class="sc">&lt;=</span>x[i])</span>
<span id="cb103-19"><a href="#cb103-19" tabindex="-1"></a>    }</span>
<span id="cb103-20"><a href="#cb103-20" tabindex="-1"></a>    <span class="fu">return</span>(R)</span>
<span id="cb103-21"><a href="#cb103-21" tabindex="-1"></a>  }</span>
<span id="cb103-22"><a href="#cb103-22" tabindex="-1"></a>  </span>
<span id="cb103-23"><a href="#cb103-23" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="cf">function</span>(vec1,vec2,x,y){</span>
<span id="cb103-24"><a href="#cb103-24" tabindex="-1"></a>    f1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec1,x)</span>
<span id="cb103-25"><a href="#cb103-25" tabindex="-1"></a>    f2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec1,y)</span>
<span id="cb103-26"><a href="#cb103-26" tabindex="-1"></a>    g1 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec2,x)</span>
<span id="cb103-27"><a href="#cb103-27" tabindex="-1"></a>    g2 <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(vec2,y)</span>
<span id="cb103-28"><a href="#cb103-28" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sum</span>(f1<span class="sc">-</span>g1)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="fu">sum</span>(f2<span class="sc">-</span>g2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb103-29"><a href="#cb103-29" tabindex="-1"></a>  }</span>
<span id="cb103-30"><a href="#cb103-30" tabindex="-1"></a>  </span>
<span id="cb103-31"><a href="#cb103-31" tabindex="-1"></a>  D0 <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">W</span>(x,y,x,y)</span>
<span id="cb103-32"><a href="#cb103-32" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb103-33"><a href="#cb103-33" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">sample</span>(k, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-34"><a href="#cb103-34" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[K]</span>
<span id="cb103-35"><a href="#cb103-35" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>K] </span>
<span id="cb103-36"><a href="#cb103-36" tabindex="-1"></a>    D[i] <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">W</span>(x1,y1,x1,y1)</span>
<span id="cb103-37"><a href="#cb103-37" tabindex="-1"></a>  }</span>
<span id="cb103-38"><a href="#cb103-38" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb103-39"><a href="#cb103-39" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb103-40"><a href="#cb103-40" tabindex="-1"></a>  p</span></code></pre></div>
<pre><code>## [1] 0.000999001</code></pre>
<p>We obtain a <span class="math inline">\(p\)</span>-value <span class="math inline">\(&lt;0.001\)</span>. For a significance level <span class="math inline">\(\alpha=0.05\)</span>, we reject the null
hypothesis, suggesting that the samples <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are from different distributions. The
analysis results for the two datasets using the Kolmogorov-Smirnov
statistic and the two-sample Cramér-von Mises statistic are
consistent.</p>
</div>
<div id="homework-6.3" class="section level3">
<h3>homework 6.3</h3>
<p>The Count 5 Test for Equal Variances in Section 6.4 is Based on the
Maximum Number of Extreme Points. Example 6.15 Shows that the Count 5
Criterion is Not Applicable for Unequal Sample Sizes. Implement a
Permutation Test for Equal Variance Based on the Maximum Number of
Extreme Points that Applies When Sample Sizes are Not Necessarily
Equal.</p>
</div>
<div id="amswer-6.3" class="section level3">
<h3>amswer 6.3</h3>
<p>In Chapter 6, we found that the Count Five statistic does not perform
well when applied to tests with different sample sizes. We use a
permutation test to handle tests with different sample sizes.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>  count5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>    X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>    outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>    outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">max</span>(<span class="fu">c</span>(outx, outy))))</span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a>  }</span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb105-12"><a href="#cb105-12" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb105-13"><a href="#cb105-13" tabindex="-1"></a>  mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb105-14"><a href="#cb105-14" tabindex="-1"></a>  sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb105-15"><a href="#cb105-15" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb105-16"><a href="#cb105-16" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb105-17"><a href="#cb105-17" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(m)</span>
<span id="cb105-18"><a href="#cb105-18" tabindex="-1"></a>  </span>
<span id="cb105-19"><a href="#cb105-19" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb105-20"><a href="#cb105-20" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb105-21"><a href="#cb105-21" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb105-22"><a href="#cb105-22" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb105-23"><a href="#cb105-23" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x) </span>
<span id="cb105-24"><a href="#cb105-24" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb105-25"><a href="#cb105-25" tabindex="-1"></a>    D0 <span class="ot">&lt;-</span> <span class="fu">count5</span>(x,y)</span>
<span id="cb105-26"><a href="#cb105-26" tabindex="-1"></a>    D <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(m)</span>
<span id="cb105-27"><a href="#cb105-27" tabindex="-1"></a>  </span>
<span id="cb105-28"><a href="#cb105-28" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb105-29"><a href="#cb105-29" tabindex="-1"></a>      K <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="at">size =</span> n1, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb105-30"><a href="#cb105-30" tabindex="-1"></a>      x1 <span class="ot">&lt;-</span> z[K]</span>
<span id="cb105-31"><a href="#cb105-31" tabindex="-1"></a>      y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>K] </span>
<span id="cb105-32"><a href="#cb105-32" tabindex="-1"></a>      D[j] <span class="ot">&lt;-</span> <span class="fu">count5</span>(x1,y1)</span>
<span id="cb105-33"><a href="#cb105-33" tabindex="-1"></a>    }</span>
<span id="cb105-34"><a href="#cb105-34" tabindex="-1"></a>    p[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb105-35"><a href="#cb105-35" tabindex="-1"></a>    <span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb105-36"><a href="#cb105-36" tabindex="-1"></a>  }</span>
<span id="cb105-37"><a href="#cb105-37" tabindex="-1"></a>  <span class="fu">mean</span>(p<span class="sc">&lt;=</span><span class="fl">0.0625</span>)</span></code></pre></div>
<pre><code>## [1] 0.037</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2</span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>  mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>  sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(m)</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a>  </span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb107-14"><a href="#cb107-14" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb107-15"><a href="#cb107-15" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x) </span>
<span id="cb107-16"><a href="#cb107-16" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb107-17"><a href="#cb107-17" tabindex="-1"></a>    D0 <span class="ot">&lt;-</span> <span class="fu">count5</span>(x,y)</span>
<span id="cb107-18"><a href="#cb107-18" tabindex="-1"></a>    D <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(m)</span>
<span id="cb107-19"><a href="#cb107-19" tabindex="-1"></a>  </span>
<span id="cb107-20"><a href="#cb107-20" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb107-21"><a href="#cb107-21" tabindex="-1"></a>      K <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="at">size =</span> n1, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb107-22"><a href="#cb107-22" tabindex="-1"></a>      x1 <span class="ot">&lt;-</span> z[K]</span>
<span id="cb107-23"><a href="#cb107-23" tabindex="-1"></a>      y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>K] </span>
<span id="cb107-24"><a href="#cb107-24" tabindex="-1"></a>      D[j] <span class="ot">&lt;-</span> <span class="fu">count5</span>(x1,y1)</span>
<span id="cb107-25"><a href="#cb107-25" tabindex="-1"></a>    }</span>
<span id="cb107-26"><a href="#cb107-26" tabindex="-1"></a>    p[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D) <span class="sc">&gt;=</span> D0)</span>
<span id="cb107-27"><a href="#cb107-27" tabindex="-1"></a>    <span class="fu">options</span>(<span class="at">warn =</span> <span class="dv">0</span>)</span>
<span id="cb107-28"><a href="#cb107-28" tabindex="-1"></a>  }</span>
<span id="cb107-29"><a href="#cb107-29" tabindex="-1"></a>  <span class="fu">mean</span>(p<span class="sc">&lt;=</span><span class="fl">0.0625</span>)</span></code></pre></div>
<pre><code>## [1] 0.059</code></pre>
<p>We use the same maxout test statistic but calculate the <span class="math inline">\(p\)</span>-value using a permutation test. For
cases with different sample sizes, the permutation test estimates the
Type I error rate at significance <span class="math inline">\(\alpha=0.0625\)</span> as 0.0447 (for <span class="math inline">\(n_1=20, n_2=30\)</span>) and 0.0509 (for <span class="math inline">\(n_1=20, n_2=50\)</span>), compared to the original
“Count Five” criterion results of 0.1064 (for <span class="math inline">\(n_1=20, n_2=30\)</span>) and 0.2934 (for <span class="math inline">\(n_1=20, n_2=50\)</span>). The permutation test
results are closer to the true significance level. In summary, using the
permutation test to calculate the <span class="math inline">\(p\)</span>-value results in a more accurate Type I
error rate and is an effective modification of the original “Count Five”
criterion.</p>
</div>
</div>
<div id="homework-7" class="section level2">
<h2>homework 7</h2>
<div id="homework-7.1" class="section level3">
<h3>homework 7.1</h3>
<p>Consider a model <span class="math inline">\(P\left(Y=1 \mid X_1,
X_2, X_3\right)=\frac{\exp \left(a+b_1 X_1+b_2 X_2+b_3
X_3\right)}{1+\exp \left(a+b_1 X_1+b_2 X_2+b_3 X_3\right)}\)</span>,
where <span class="math inline">\(X_1 \sim P(1), X_2 \sim
\operatorname{Exp}(1)\)</span> and <span class="math inline">\(X_3 \sim
B(1,0.5)\)</span>.</p>
</div>
<div id="answer-7.1" class="section level3">
<h3>answer 7.1</h3>
<p>We denote <span class="math inline">\(P(Y=1)=f_0\)</span>，where
<span class="math inline">\(f_0\)</span>is given. For observed data
<span class="math inline">\(\left(x_{1 i}, x_{2 i},x_{3
i}\right)\)</span>, <span class="math inline">\(i=1, \ldots, N\)</span>,
using the total expectation formula, we note that <span class="math display">\[
P(Y=1)=E\left(P\left(Y=1 \mid X_1, X_2, X_3\right)\right).
\]</span></p>
<p>Thus, we have an estimate for <span class="math inline">\(P(Y=1)-f_0\)</span>: <span class="math display">\[
g(a)=\frac{1}{N} \sum_{i=1}^N P\left(Y=1 \mid X_{1i}, X_{2i},
X_{3i}\right)-f_0=\frac{1}{N}\sum_{i=1}^N \frac{1}{1+\exp \left(-a-b_1
X_{1i}-b_2 X_{2i}-b_3 X_{3i}\right)}-f_0,
\]</span></p>
<p>Using the root-finding function uniroot, we solve <span class="math inline">\(g(a)=0\)</span> to obtain the corresponding<span class="math inline">\(a\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Following this idea, we present the logisticroot function, which
inputs <span class="math inline">\(N, b_1, b_2, b_3\)</span> and <span class="math inline">\(f_0\)</span> to solve for <span class="math inline">\(a\)</span>.</li>
</ol>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>  logisticroot <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>    X3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>    z <span class="ot">&lt;-</span> <span class="cf">function</span>(a,X1,X2,X3,b1,b2,b3,f0){</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(N)</span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a>      p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b1<span class="sc">*</span>X1<span class="sc">-</span>b2<span class="sc">*</span>X2<span class="sc">-</span>b3<span class="sc">*</span>X3))</span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">mean</span>(p)<span class="sc">-</span>f0)</span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a>    }</span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">uniroot</span>(z,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1000</span>,<span class="dv">1000</span>),<span class="at">X1=</span>X1,<span class="at">X2=</span>X2,<span class="at">X3=</span>X3,<span class="at">b1=</span>b1,<span class="at">b2=</span>b2,<span class="at">b3=</span>b3,<span class="at">f0=</span>f0)<span class="sc">$</span>root)</span>
<span id="cb109-11"><a href="#cb109-11" tabindex="-1"></a>  }</span>
<span id="cb109-12"><a href="#cb109-12" tabindex="-1"></a>  <span class="do">##示例</span></span>
<span id="cb109-13"><a href="#cb109-13" tabindex="-1"></a>  <span class="fu">logisticroot</span>(<span class="dv">10000</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] -4.307745</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>For <span class="math inline">\(N=10^6, b_1=0, b_2=1,
b_3=-1\)</span>,<span class="math inline">\(f_0=0.1,0.01,0.001,0.0001\)</span>, we run the
function to obtain four values of <span class="math inline">\(a\)</span>.</li>
</ol>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fl">1e4</span>;b1 <span class="ot">&lt;-</span> <span class="dv">0</span>;b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>  <span class="fu">logisticroot</span>(N,b1,b2,b3,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] -3.187598</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>  <span class="fu">logisticroot</span>(N,b1,b2,b3,<span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] -6.010705</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a>  <span class="fu">logisticroot</span>(N,b1,b2,b3,<span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>## [1] -8.481922</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>  <span class="fu">logisticroot</span>(N,b1,b2,b3,<span class="fl">0.0001</span>)</span></code></pre></div>
<pre><code>## [1] -11.08756</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Considering the given parameters <span class="math inline">\(N\)</span>、<span class="math inline">\(b1\)</span>、<span class="math inline">\(b2\)</span> and <span class="math inline">\(b3\)</span>, we plot <span class="math inline">\(-\log f_0\)</span> and the estimated <span class="math inline">\(a\)</span> values from the logisticroot
function.</li>
</ol>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fl">1e4</span>;b1 <span class="ot">&lt;-</span> <span class="dv">0</span>;b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="fl">0.0001</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">logisticroot</span>(N,b1,b2,b3,<span class="fu">exp</span>(m[i]))</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>  }</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>  y</span></code></pre></div>
<pre><code>##   [1] -12.2105493 -11.5927437 -11.4512525 -11.5776282 -11.2639922 -12.4515676
##   [7] -11.1847391 -11.1026976 -11.6854276 -11.1072176 -11.2014544 -10.8126831
##  [13] -10.7940215 -10.5151777 -10.5211911 -10.4807482 -10.2997976 -10.2208694
##  [19] -10.0091515 -10.1318872  -9.8426566  -9.6690312  -9.6526474  -9.6959227
##  [25]  -9.7521640  -9.6024647  -9.0551210  -9.0323908  -8.7926183  -9.1527591
##  [31]  -8.7969659  -8.6780472  -8.6215424  -8.4762080  -8.3976250  -8.2413892
##  [37]  -8.1747955  -7.9730002  -7.9858780  -7.7328733  -7.6170242  -7.4607372
##  [43]  -7.4140604  -7.2729123  -7.0947012  -7.1316494  -6.8963163  -6.8055653
##  [49]  -6.7129482  -6.5783457  -6.4240680  -6.3130263  -6.2580503  -6.0402117
##  [55]  -6.0071727  -5.8670337  -5.7827298  -5.6845993  -5.5190756  -5.3966629
##  [61]  -5.2717351  -5.1958118  -5.0419034  -4.9161993  -4.7773998  -4.6718282
##  [67]  -4.5053878  -4.4040993  -4.2288837  -4.1204892  -3.9536328  -3.8582904
##  [73]  -3.7224884  -3.6099202  -3.4741913  -3.3334112  -3.2053179  -3.0400680
##  [79]  -2.8956108  -2.7968513  -2.6146248  -2.5013768  -2.2994775  -2.1469635
##  [85]  -1.9732713  -1.8353100  -1.6535620  -1.4724860  -1.2997784  -1.1093405
##  [91]  -0.9028444  -0.6895831  -0.4580916  -0.2052282   0.0647982   0.3988671
##  [97]   0.7986705   1.3219779   2.1165258   9.1413694</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> m, <span class="at">Y =</span> y)</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;a&quot;</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;log(f0)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We focus only on the relationship between <span class="math inline">\(f_0\)</span> and <span class="math inline">\(a\)</span>, noting that <span class="math inline">\(f_0=\frac{1}{1+\exp \left(-a-b_1 X_1-b_2 X_2-b_3
X_3\right)}\)</span>, hence <span class="math inline">\(-\log f_0
\propto log(1+ce^{-a})\)</span>, where <span class="math inline">\(c&gt;0\)</span> is a parameter unrelated to <span class="math inline">\(a\)</span>. We set <span class="math inline">\(c=0.01\)</span> and plot <span class="math inline">\(x=-log(1+ce^{-y}),x&lt;0\)</span>,<span class="math inline">\((y=\log(\frac{c}{e^{-x}-1})\)</span>。</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="fl">0.0001</span>,<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">log</span>(c<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>  <span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The trends of the two plots are basically consistent, indicating that
our function for solving the logistic regression parameter <span class="math inline">\(a\)</span> is accurate.</p>
</div>
<div id="homework-7.2" class="section level3">
<h3>homework 7.2</h3>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
</div>
<div id="answer-7.2" class="section level3">
<h3>answer 7.2</h3>
<p>We choose the proposal distribution <span class="math inline">\(g\left(Y \mid
X_t\right)=g\left(\left|X_t-Y\right|\right)=g(X_t \mid Y)\)</span>,
resulting in the acceptance probability <span class="math inline">\(\alpha\left(X_t, Y\right)\)</span> expressed as
<span class="math display">\[
\alpha\left(X_t, Y\right)=\min \left(1,\frac{f(Y) g\left(X_t \mid
Y\right)}{f\left(X_t\right) g\left(Y \mid X_t\right)}\right)=\min
\left(1, \frac{f(Y)}{f\left(X_t\right)}\right) .
\]</span></p>
<p>Here, <span class="math inline">\(f\)</span>represents the Laplace
distribution. <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x \in
R.\)</span> At step <span class="math inline">\(t\)</span>, given <span class="math inline">\(X_t\)</span>,we generate an increment <span class="math inline">\(Z \sim N(0,\sigma^2)\)</span> and set <span class="math inline">\(Y=X_t+Z\)</span>, We accept <span class="math inline">\(X_{t+1}=Y\)</span> with probability <span class="math inline">\(\alpha(X_t,Y)\)</span>; otherwise, <span class="math inline">\(X_{t+1}=X_t\)</span>。</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="do">##k代表拒绝的次数</span></span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(B,<span class="dv">0</span>,sigma)</span>
<span id="cb123-7"><a href="#cb123-7" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(B)</span>
<span id="cb123-8"><a href="#cb123-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>B){</span>
<span id="cb123-9"><a href="#cb123-9" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]<span class="sc">+</span>Z[i]</span>
<span id="cb123-10"><a href="#cb123-10" tabindex="-1"></a>    <span class="cf">if</span>(U[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(Y)<span class="sc">+</span><span class="fu">abs</span>(X[i<span class="dv">-1</span>]))){</span>
<span id="cb123-11"><a href="#cb123-11" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb123-12"><a href="#cb123-12" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb123-13"><a href="#cb123-13" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb123-14"><a href="#cb123-14" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb123-15"><a href="#cb123-15" tabindex="-1"></a>    }</span>
<span id="cb123-16"><a href="#cb123-16" tabindex="-1"></a>  }</span>
<span id="cb123-17"><a href="#cb123-17" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">fig =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.95</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb123-18"><a href="#cb123-18" tabindex="-1"></a>  <span class="fu">plot</span>(X,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span><span class="fl">0.5</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8TF+hAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG5UlEQVR4nO3da3viRABA4VF366VV113FC0rb+f8/0kCuk9tJgITAnvPBh0LCJK9DCH1SNkQbLdx6A7aeQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkEDQmkDhtp250dc12MxYVxt9a0DX3J4w8tOZT7JsAvWP0D4KjA55xe0JdwLUGSsMDRs6O3XZcHcKdNruXoiLgVoidwuUQITk8fz+Ab2BR9rLlLcfAyiMAoXOyhMGKG/fOVB5QCp3PNRA9UldWy+kBK1nD22g0BU+c6PXqWnRBgr5/vUA1Yf2AigU900HGnzdTt7odeoCherGCSiUsysBKhb4moBCta8FSROoPmNqTKoEKPTtca0bq5XLZ9oI0PuXfJO+/Wd0rAqoPn1sA8UUqJxH9QQLlVL13LVu847GOcXNgfbhOb9xKG/0j9UFqlTqe6olGztZPND/8TwVjynQJXt6NaD3LxXL/sN/I2O1gJozov6peEdrApUPjADF1uKbAnp7+VzePCQvstYehfSeHqDivllATeyNAk2dQaF+y4r1vswCaqxcnQTUQHGjQNkxqJhC48egDlBMdq0zTbpAsdKMXaDYACoX2ghQ9iLLN3Ng/owDJSdEjaN1debTmCL5uVQbKKZAtWJojD6/9c+DYvGeXe9jcm6dHpdq1OT8qfg5Nva+/LASy7sr/DsFirF6N299+Iixeg9LgWIXqL1S+3ZcG+ivoZPAWWOl2xySudAAim2g2JhoXaCYApVDLQ/09qm89fo0eJZ81li9QMUDg0D1Ml2gauXGTysAvXzzx+nGbvhTxHljJfvcerR5mtPY5QQoTAIaGn1aU1bLPmR9PE6f438vaS2g5GNa6NyY17TVDuGbX0Mxj85vaKz++5OdDN1lqvPKzlPcAKiYRBf2wED74wy67AA0MtYlQJGAcHRoymrZKfLH038HPkLACMlHhrO2YWjVjQAt9y42dRsGgcI2gBY7D5q84hhQdXLYGGfll1ij65xJz17xfoAuagGgKNBpxcHj+x0CvT59Hnro/LEeAaj8ddmxgUP5IkDxXoDK37QuMoPGVu0B6vW8OVA2h46/bL0JUPrwVoGyM8nsjFKgsfbheX2gcEdA2fz5rg3En8Uu676Ajr8XWWIGjRQ6n/X7/09sBmj4I79AUSBsfaDur9MEaj1t+6AsUOtp2yCbBrrFWALR87aBrjm6QPTk5622qbGmPa9Ay4z+CECLjr4q0G07c6Ova3D2gFe5e+7iUxIIEggSCBIIEggSCBIIEgi67en/HSQQJBAkECQQJBAkECQQJBAkECQQJBAkELQu0CFM+8PO3enbG6qlR1fbh5Bf9Tdt8bmtCnTItvswYdsPp6+3qJYeXW1/fPAoNG3x2a0JlF87tMM/fn17OQJVS4+u9v7lY2upqaNMbE2g/BLqPf5R3v7D7xlQtfToahXQtMXntyrQ98d5f6BNzxY7HoOqpcdXK19iExef3ZpA+YGBDg/Hl8gRqFoaVisOyVMXn9v2gI7fXzUDaJdNlden54cAmjT5TwtNf4nVh54HeIlNOnzui4tVPk876lbz5REO0tPfgHeT3+Zzjmy+PMLb/PRTuN30E8XyGPQIJ4qn18+MjxrV0qOr7bLX43OcvPjc/LAKCQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBN0ZUPMK3/wbrK91FcdQ9wWUXLiRXym1dHcFlF76c7WLyEa7K6D04rH90q+uU1sEev/z6XQVXucrK9PLD3c/9C1z7bYItPvwd3z91PNvbSYXsObfEL9bWmiDQMU8+en0w664pvP0cuq5wnfxA9EGgfJ9fvu5+x7Vc4XvyDfEX6ftAr1097znCt/F3+s3CJTTFFMjeYklb/PVBcDLbs0GgbKDzG+ZRd+/iJycKJ6gvsaDdIz//hLCj73/YnRxhW/xR1Dl3xou2SaBtpRAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBA0P+LEP02qMtLOwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>  <span class="fu">print</span>(k<span class="sc">/</span>B)</span></code></pre></div>
<pre><code>## [1] 0.166</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb126-3"><a href="#cb126-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb126-4"><a href="#cb126-4" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb126-5"><a href="#cb126-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="do">##k代表拒绝的次数</span></span>
<span id="cb126-6"><a href="#cb126-6" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(B,<span class="dv">0</span>,sigma)</span>
<span id="cb126-7"><a href="#cb126-7" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(B)</span>
<span id="cb126-8"><a href="#cb126-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>B){</span>
<span id="cb126-9"><a href="#cb126-9" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]<span class="sc">+</span>Z[i]</span>
<span id="cb126-10"><a href="#cb126-10" tabindex="-1"></a>    <span class="cf">if</span>(U[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(Y)<span class="sc">+</span><span class="fu">abs</span>(X[i<span class="dv">-1</span>]))){</span>
<span id="cb126-11"><a href="#cb126-11" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb126-12"><a href="#cb126-12" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb126-13"><a href="#cb126-13" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb126-14"><a href="#cb126-14" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb126-15"><a href="#cb126-15" tabindex="-1"></a>    }</span>
<span id="cb126-16"><a href="#cb126-16" tabindex="-1"></a>  }</span>
<span id="cb126-17"><a href="#cb126-17" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">fig =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.95</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb126-18"><a href="#cb126-18" tabindex="-1"></a>  <span class="fu">plot</span>(X,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span><span class="dv">1</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>  <span class="fu">print</span>(k<span class="sc">/</span>B)</span></code></pre></div>
<pre><code>## [1] 0.306</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="do">##k代表拒绝的次数</span></span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(B,<span class="dv">0</span>,sigma)</span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(B)</span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>B){</span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]<span class="sc">+</span>Z[i]</span>
<span id="cb129-10"><a href="#cb129-10" tabindex="-1"></a>    <span class="cf">if</span>(U[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(Y)<span class="sc">+</span><span class="fu">abs</span>(X[i<span class="dv">-1</span>]))){</span>
<span id="cb129-11"><a href="#cb129-11" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb129-12"><a href="#cb129-12" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb129-13"><a href="#cb129-13" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb129-14"><a href="#cb129-14" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb129-15"><a href="#cb129-15" tabindex="-1"></a>    }</span>
<span id="cb129-16"><a href="#cb129-16" tabindex="-1"></a>  }</span>
<span id="cb129-17"><a href="#cb129-17" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">fig =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.95</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb129-18"><a href="#cb129-18" tabindex="-1"></a>  <span class="fu">plot</span>(X,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span><span class="fl">2.5</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>  <span class="fu">print</span>(k<span class="sc">/</span>B)</span></code></pre></div>
<pre><code>## [1] 0.56</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(B)</span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="do">##k代表拒绝的次数</span></span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(B,<span class="dv">0</span>,sigma)</span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(B)</span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>B){</span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]<span class="sc">+</span>Z[i]</span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a>    <span class="cf">if</span>(U[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(Y)<span class="sc">+</span><span class="fu">abs</span>(X[i<span class="dv">-1</span>]))){</span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> Y</span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a>      X[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>]</span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a>    }</span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a>  }</span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">fig =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.95</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span>))</span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a>  <span class="fu">plot</span>(X,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma<span class="sc">==</span><span class="dv">16</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>  <span class="fu">print</span>(k<span class="sc">/</span>B)</span></code></pre></div>
<pre><code>## [1] 0.892</code></pre>
<p>In the generated chains, only <span class="math inline">\(\sigma=0.5\)</span> and <span class="math inline">\(\sigma=1\)</span> yield rejection probabilities
within the range <span class="math inline">\([0.15,0.5]\)</span>.
However, the chain corresponding to <span class="math inline">\(\sigma=0.5\)</span> does not demonstrate good
convergence. Therefore, we conclude that <span class="math inline">\(\sigma=1\)</span> provides the best fit.</p>
</div>
<div id="homework-7.3" class="section level3">
<h3>homework 7.3</h3>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\(\left(X_t, Y_t\right)\)</span> with zero means,
unit standard deviations, and correlation 0.9 . Plot the generated
sample after discarding a suitable burn-in sample. Fit a simple linear
regression model <span class="math inline">\(Y=\beta_0+\beta_1
X\)</span> to the sample and check the residuals of the model for
normality and constant variance.</p>
</div>
<div id="answer-7.3" class="section level3">
<h3>answer 7.3</h3>
<p>To generate a two-dimensional normal vector with parameters mean
<span class="math inline">\(\left(\mu_1, \mu_2\right)\)</span>,
variances <span class="math inline">\(\sigma_1^2, \sigma_2^2\)</span>
and correlation coefficient <span class="math inline">\(\rho\)</span>,we
use the Gibbs sampling method. For <span class="math inline">\(Z=\left(X_t, Y_t\right), Z_{(-1)}=Y_t,
Z_{(-2)}=X_t\)</span>, the conditional distributions for a normal
variable are: <span class="math display">\[
E\left[Y_t \mid X_t\right]=\mu_1+\rho
\frac{\sigma_2}{\sigma_1}\left(x_1-\mu_1\right),
Var\left(Y_t \mid X_t\right)=\left(1-\rho^2\right) \sigma_2^2
\]</span></p>
<p>The chain is generated as follows:</p>
<p><span class="math display">\[
f\left(X_t \mid Y_t\right) \sim
\operatorname{Normal}\left(\mu_1+\frac{\rho
\sigma_1}{\sigma_2}\left(Y_t-\mu_2\right),\left(1-\rho^2\right)
\sigma_1^2\right), \\
f\left(Y_t \mid X_t\right) \sim
\operatorname{Normal}\left(\mu_2+\frac{\rho
\sigma_2}{\sigma_1}\left(X_t-\mu_1\right),\left(1-\rho^2\right)
\sigma_2^2\right) .
\]</span></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>  burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) </span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>  rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> </span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a>  mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a>  mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>  sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>  sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb135-10"><a href="#cb135-10" tabindex="-1"></a>  s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb135-11"><a href="#cb135-11" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) </span>
<span id="cb135-12"><a href="#cb135-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb135-13"><a href="#cb135-13" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb135-14"><a href="#cb135-14" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb135-15"><a href="#cb135-15" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb135-16"><a href="#cb135-16" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb135-17"><a href="#cb135-17" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb135-18"><a href="#cb135-18" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb135-19"><a href="#cb135-19" tabindex="-1"></a>  }</span>
<span id="cb135-20"><a href="#cb135-20" tabindex="-1"></a>  b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb135-21"><a href="#cb135-21" tabindex="-1"></a>  x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span></code></pre></div>
<p>Fit a linear model and check the normality of residuals with a QQ
plot:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>  vecx <span class="ot">&lt;-</span> x[,<span class="dv">1</span>]</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>  vecy <span class="ot">&lt;-</span> x[,<span class="dv">2</span>]</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(vecy<span class="sc">~</span>vecx)</span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>  res <span class="ot">&lt;-</span> fit<span class="sc">$</span>residuals</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>  <span class="fu">qqnorm</span>(res)</span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>  <span class="fu">qqline</span>(res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Test for homogeneity of variances using the bartlett.test
function:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>  value <span class="ot">&lt;-</span> <span class="fu">c</span>(vecy,vecx)</span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>  group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4000</span>),<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4000</span>))</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>  <span class="fu">bartlett.test</span>(value<span class="sc">~</span>group)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  value by group
## Bartlett&#39;s K-squared = 3.1232e-05, df = 1, p-value = 0.9955</code></pre>
<p>With a p-value of 0.9893, the large p-value suggests the homogeneity
of variances hypothesis is valid. From the QQ plot and the fitted line,
the assumption of normality of residuals is reasonable.</p>
</div>
<div id="homework-7.4" class="section level3">
<h3>homework 7.4</h3>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>. (See Exercise 9.9.) Also
use the coda [212] package to check for convergence of the chain by the
Gelman-Rubin method. Hints: See the help topics for the coda functions
gelman.diag, gelman.plot, as.mcmc, and mcmc.list.</p>
</div>
<div id="answer-7.4" class="section level3">
<h3>answer 7.4</h3>
<p>First, use the Metropolis-Hastings sampling method to generate a
chain for the Rayleigh distribution. The density function of the
Rayleigh distribution is:</p>
<p><span class="math display">\[
f(x)=\frac{x}{\sigma^2} e^{-x^2 /\left(2 \sigma^2\right)}, \quad x \geq
0, \sigma&gt;0 .
\]</span></p>
<p>If the target distribution is Rayleigh, the acceptance probability
<span class="math inline">\(r\left(x_t, y\right)\)</span> is expressed
as: <span class="math display">\[
r\left(x_t, y\right)=\frac{f(y) g\left(x_t \mid
y\right)}{f\left(x_t\right) g\left(y \mid x_t\right)}=\frac{y e^{-y^2 /
2 \sigma^2}}{x_t e^{-x_t^2 / 2 \sigma^2}} \times
\frac{\Gamma\left(\frac{x_t}{2}\right) 2^{x_t / 2} x_t^{y / 2-1} e^{-x_t
/ 2}}{\Gamma\left(\frac{y}{2}\right) 2^{y / 2} y^{x_t / 2-1} e^{-y / 2}}
.
\]</span></p>
<p>Generate chains using the genchain function, and analyze convergence
with gelman.diag from the coda package:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a>  <span class="do">## genchain为生成链的函数</span></span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>  genchain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>    f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a>      <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a>      <span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a>    }</span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb139-10"><a href="#cb139-10" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb139-11"><a href="#cb139-11" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb139-12"><a href="#cb139-12" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb139-13"><a href="#cb139-13" tabindex="-1"></a>      xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb139-14"><a href="#cb139-14" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb139-15"><a href="#cb139-15" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb139-16"><a href="#cb139-16" tabindex="-1"></a>      den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb139-17"><a href="#cb139-17" tabindex="-1"></a>      <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den){</span>
<span id="cb139-18"><a href="#cb139-18" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> y </span>
<span id="cb139-19"><a href="#cb139-19" tabindex="-1"></a>      }<span class="cf">else</span> {</span>
<span id="cb139-20"><a href="#cb139-20" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb139-21"><a href="#cb139-21" tabindex="-1"></a>      }</span>
<span id="cb139-22"><a href="#cb139-22" tabindex="-1"></a>    }</span>
<span id="cb139-23"><a href="#cb139-23" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb139-24"><a href="#cb139-24" tabindex="-1"></a>  }</span>
<span id="cb139-25"><a href="#cb139-25" tabindex="-1"></a></span>
<span id="cb139-26"><a href="#cb139-26" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb139-27"><a href="#cb139-27" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co">#number of chains to generate</span></span>
<span id="cb139-28"><a href="#cb139-28" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb139-29"><a href="#cb139-29" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co">#burn-in length</span></span>
<span id="cb139-30"><a href="#cb139-30" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">5</span>,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb139-31"><a href="#cb139-31" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb139-32"><a href="#cb139-32" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb139-33"><a href="#cb139-33" tabindex="-1"></a>    X[i, ] <span class="ot">&lt;-</span> <span class="fu">genchain</span>(sigma, n, x0[i]) </span>
<span id="cb139-34"><a href="#cb139-34" tabindex="-1"></a>  }</span>
<span id="cb139-35"><a href="#cb139-35" tabindex="-1"></a>  mc1 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">1</span>,])</span>
<span id="cb139-36"><a href="#cb139-36" tabindex="-1"></a>  mc2 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">2</span>,])</span>
<span id="cb139-37"><a href="#cb139-37" tabindex="-1"></a>  mc3 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">3</span>,])</span>
<span id="cb139-38"><a href="#cb139-38" tabindex="-1"></a>  mc4 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">4</span>,])</span>
<span id="cb139-39"><a href="#cb139-39" tabindex="-1"></a>  mc5 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">5</span>,])</span>
<span id="cb139-40"><a href="#cb139-40" tabindex="-1"></a>  <span class="fu">gelman.diag</span>(<span class="fu">mcmc.list</span>(mc1,mc2,mc3,mc4,mc5))</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.01       1.02</code></pre>
<p>Using the gelman.diag function, we can infer that these five chains
eventually converge to the same target distribution. Additionally,
calculate the Gelman-Rubin statistic:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>  Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>    psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) </span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a>    B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) </span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a>    psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) </span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a>    W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) </span>
<span id="cb141-9"><a href="#cb141-9" tabindex="-1"></a>    v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) </span>
<span id="cb141-10"><a href="#cb141-10" tabindex="-1"></a>    r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W </span>
<span id="cb141-11"><a href="#cb141-11" tabindex="-1"></a>    <span class="fu">return</span>(r.hat)</span>
<span id="cb141-12"><a href="#cb141-12" tabindex="-1"></a>  }</span>
<span id="cb141-13"><a href="#cb141-13" tabindex="-1"></a></span>
<span id="cb141-14"><a href="#cb141-14" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb141-15"><a href="#cb141-15" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb141-16"><a href="#cb141-16" tabindex="-1"></a>    psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb141-17"><a href="#cb141-17" tabindex="-1"></a>  }</span>
<span id="cb141-18"><a href="#cb141-18" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.313252</code></pre>
<p>The estimated Gelman-Rubin statistic is 1.06 &lt; 1.2, indicating
that the five chains have approximately converged to the same target
distribution.</p>
</div>
</div>
<div id="homework-8" class="section level2">
<h2>homework 8</h2>
<div id="homework-8.1" class="section level3">
<h3>homework 8.1</h3>
<p>Let <span class="math inline">\(X_1,\dots,X_n iid \sim
Exp(\lambda)\)</span>. For some reason, it is only known that each <span class="math inline">\(X_i\)</span> is within a certain interval <span class="math inline">\((u_i,v_i)\)</span>, where <span class="math inline">\(u_i&lt;v_i\)</span> are two non-random known
constants. This type of data is known as interval-censored data.</p>
<ol style="list-style-type: decimal">
<li><p>Directly maximize the likelihood function of the observed data
and use the EM algorithm to solve for the MLE of <span class="math inline">\(\lambda\)</span>, proving that the EM algorithm
converges to the MLE of the observed data with linear speed.</p></li>
<li><p>Given the observed values <span class="math inline">\((u_i,v_i),i=1,\dots,n(n=10)\)</span> as <span class="math inline">\((11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\)</span>,
implement both methods to numerically solve for the MLE of <span class="math inline">\(\lambda\)</span>.</p></li>
</ol>
<p>Hint: The likelihood function of the observed data is
$L()=<em>{i=1}^n P</em>(u_i X_i v_i) $.</p>
</div>
</div>
<div id="answer-8.1" class="section level2">
<h2>answer 8.1</h2>
<ol style="list-style-type: decimal">
<li>Directly maximizing the likelihood function <span class="math inline">\(L(\lambda)=\prod_{i=1}^n P_\lambda\left(u_i
\leqslant X_i \leqslant v_i\right).\)</span> Since <span class="math inline">\(X_i\)</span> follows an exponential distribution,
for each <span class="math inline">\(i\)</span>, <span class="math inline">\(P_\lambda\left(u_i \leq X_i \leq
v_i\right)=e^{-\lambda u_i}-e^{-\lambda v_i}\)</span>. thus, the
likelihood function <span class="math inline">\(L(\lambda)=\prod_{i=1}^n\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)\)</span>. To find the MLE, solve <span class="math inline">\(\frac{d}{d \lambda} \log (L(\lambda))=\frac{d}{d
\lambda} (\sum_{i=1}^n\log\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right))=\sum_{i=1}^n\frac{-u_ie^{-\lambda u_i}+v_i e^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0\)</span>. This can be done
using numerical methods. The direct_MLE function is written to solve
this problem, using the uniroot function to numerically solve <span class="math inline">\(\frac{d}{d \lambda} \log (L(\lambda))=0\)</span>
for <span class="math inline">\(\lambda\)</span>,i.e., the MLE of <span class="math inline">\(\lambda\)</span>。</li>
</ol>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a>  direct_MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(u, v) {</span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>    f <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, u, v) {</span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a>        r <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(n)</span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb143-6"><a href="#cb143-6" tabindex="-1"></a>          r[i] <span class="ot">&lt;-</span> (<span class="sc">-</span>u[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">+</span>v[i]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u[i])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v[i]))</span>
<span id="cb143-7"><a href="#cb143-7" tabindex="-1"></a>        }</span>
<span id="cb143-8"><a href="#cb143-8" tabindex="-1"></a>        <span class="fu">return</span>(<span class="fu">sum</span>(r))</span>
<span id="cb143-9"><a href="#cb143-9" tabindex="-1"></a>    }</span>
<span id="cb143-10"><a href="#cb143-10" tabindex="-1"></a>    opt <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(f,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>),<span class="at">u=</span>u,<span class="at">v=</span>v)<span class="sc">$</span>root</span>
<span id="cb143-11"><a href="#cb143-11" tabindex="-1"></a>    <span class="fu">return</span>(opt)</span>
<span id="cb143-12"><a href="#cb143-12" tabindex="-1"></a>  }</span>
<span id="cb143-13"><a href="#cb143-13" tabindex="-1"></a></span>
<span id="cb143-14"><a href="#cb143-14" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">2</span>)</span>
<span id="cb143-15"><a href="#cb143-15" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">3</span>)</span>
<span id="cb143-16"><a href="#cb143-16" tabindex="-1"></a>  <span class="fu">direct_MLE</span>(u,v)</span></code></pre></div>
<pre><code>## [1] 0.07196822</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Using the EM algorithm to solve for the MLE of <span class="math inline">\(\lambda\)</span>. As we only know each observation
<span class="math inline">\(X_i\)</span> is within an interval <span class="math inline">\(\left(u_i, v_i\right)\)</span>, here <span class="math inline">\(X_i\)</span> is a latent variable, as their exact
values are unknown. Assume the latent variables <span class="math inline">\(X_i\)</span> are known, the observed data is <span class="math inline">\(Z_i=\left\{u_i&lt;X_i&lt;v_i\right\}\)</span>.
First, consider the <span class="math inline">\(\mathrm{E}\)</span> step
in the <span class="math inline">\(\mathrm{EM}\)</span> algorithm,
calculate <span class="math inline">\(E\left(X_i \mid
Z_i\right)=\)</span> <span class="math inline">\(E\left(X_i \mid
u_i&lt;X_i&lt;v_i\right)\)</span>. Next, compute the conditional
probability <span class="math inline">\(P\left(X_i \leq x \mid
u_i&lt;X_i&lt;v_i\right)\)</span>. The EM step updates <span class="math inline">\(\lambda\)</span> as the MLE given <span class="math inline">\(E\left(X_i \mid Z_i\right)\)</span>. Iteratively
applying this process yields the MLE of <span class="math inline">\(\lambda\)</span>. The ‘EM_MLE’ function is written
to compute this MLE.</li>
</ol>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a>  EM_MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(u, v, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb145-4"><a href="#cb145-4" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb145-5"><a href="#cb145-5" tabindex="-1"></a>        E_X <span class="ot">&lt;-</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> u) <span class="sc">*</span> u <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> v) <span class="sc">*</span> v <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>lambda <span class="sc">*</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> v))) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> v))</span>
<span id="cb145-6"><a href="#cb145-6" tabindex="-1"></a>        lambda_new <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="fu">sum</span>(E_X)</span>
<span id="cb145-7"><a href="#cb145-7" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb145-8"><a href="#cb145-8" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb145-9"><a href="#cb145-9" tabindex="-1"></a>        }</span>
<span id="cb145-10"><a href="#cb145-10" tabindex="-1"></a>        lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb145-11"><a href="#cb145-11" tabindex="-1"></a>    }</span>
<span id="cb145-12"><a href="#cb145-12" tabindex="-1"></a>    <span class="fu">return</span>(lambda)</span>
<span id="cb145-13"><a href="#cb145-13" tabindex="-1"></a>  }</span>
<span id="cb145-14"><a href="#cb145-14" tabindex="-1"></a>  <span class="fu">EM_MLE</span>(u, v)</span></code></pre></div>
<pre><code>## [1] 0.07197367</code></pre>
<p>Both methods yield essentially consistent estimates for the MLE of
<span class="math inline">\(\lambda\)</span>.</p>
<div id="homework-8.2" class="section level3">
<h3>homework 8.2</h3>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute <span class="math inline">\(\mathrm{B} &lt;- \mathrm{A} + 2\)</span>, find the
solution of game <span class="math inline">\(B\)</span>, and verify that
it is one of the extreme points (11.12)-(11.15) of the original game
<span class="math inline">\(A\)</span>. Also find the value of game
<span class="math inline">\(A\)</span> and game <span class="math inline">\(B\)</span>.</p>
</div>
<div id="answer-8.2" class="section level3">
<h3>answer 8.2</h3>
<p>In the Morra game, if a constant is subtracted from every element of
the payoff matrix, or if every element is multiplied by a positive
constant, the set of optimal strategies does not change. However, the
simplex algorithm may terminate at different optimal points. We use the
solve.game function provided in the textbook to solve this problem.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>  solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>    <span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a>    <span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a>    <span class="co">#maximize v subject to ...</span></span>
<span id="cb147-5"><a href="#cb147-5" tabindex="-1"></a>    <span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb147-6"><a href="#cb147-6" tabindex="-1"></a>    <span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb147-7"><a href="#cb147-7" tabindex="-1"></a>    min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb147-8"><a href="#cb147-8" tabindex="-1"></a>    A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb147-9"><a href="#cb147-9" tabindex="-1"></a>    max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb147-10"><a href="#cb147-10" tabindex="-1"></a>    A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb147-11"><a href="#cb147-11" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb147-12"><a href="#cb147-12" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb147-13"><a href="#cb147-13" tabindex="-1"></a>    it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb147-14"><a href="#cb147-14" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb147-15"><a href="#cb147-15" tabindex="-1"></a>    A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb147-16"><a href="#cb147-16" tabindex="-1"></a>    b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb147-17"><a href="#cb147-17" tabindex="-1"></a>    A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb147-18"><a href="#cb147-18" tabindex="-1"></a>    b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb147-19"><a href="#cb147-19" tabindex="-1"></a>    sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb147-20"><a href="#cb147-20" tabindex="-1"></a>    <span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb147-21"><a href="#cb147-21" tabindex="-1"></a>    <span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb147-22"><a href="#cb147-22" tabindex="-1"></a>    <span class="co">#minimize v subject to ...</span></span>
<span id="cb147-23"><a href="#cb147-23" tabindex="-1"></a>    <span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb147-24"><a href="#cb147-24" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb147-25"><a href="#cb147-25" tabindex="-1"></a>    A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb147-26"><a href="#cb147-26" tabindex="-1"></a>    b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb147-27"><a href="#cb147-27" tabindex="-1"></a>    A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb147-28"><a href="#cb147-28" tabindex="-1"></a>    b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb147-29"><a href="#cb147-29" tabindex="-1"></a>    sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb147-30"><a href="#cb147-30" tabindex="-1"></a>    <span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb147-31"><a href="#cb147-31" tabindex="-1"></a>    soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb147-32"><a href="#cb147-32" tabindex="-1"></a>                 <span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb147-33"><a href="#cb147-33" tabindex="-1"></a>                 <span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb147-34"><a href="#cb147-34" tabindex="-1"></a>                 <span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb147-35"><a href="#cb147-35" tabindex="-1"></a>    soln</span>
<span id="cb147-36"><a href="#cb147-36" tabindex="-1"></a>  }</span></code></pre></div>
<p>Change the payoff matrix by setting <span class="math inline">\(\mathrm{B} \leftarrow \mathrm{A}+2\)</span> or
<span class="math inline">\(\mathrm{B} \leftarrow 2 *
\mathrm{~A}\)</span>.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a>  <span class="fu">library</span>(boot)</span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>        <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>        <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a>        <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb148-7"><a href="#cb148-7" tabindex="-1"></a>        <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb148-8"><a href="#cb148-8" tabindex="-1"></a>        <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb148-9"><a href="#cb148-9" tabindex="-1"></a>        <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb148-10"><a href="#cb148-10" tabindex="-1"></a>        <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb148-11"><a href="#cb148-11" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A)</span>
<span id="cb148-12"><a href="#cb148-12" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(m<span class="sc">$</span>x, m<span class="sc">$</span>y), <span class="dv">6</span>))</span></code></pre></div>
<pre><code>##        [,1]     [,2]
## x1 0.000000 0.000000
## x2 0.000000 0.000000
## x3 0.409836 0.409836
## x4 0.000000 0.000000
## x5 0.327869 0.327869
## x6 0.000000 0.000000
## x7 0.262295 0.262295
## x8 0.000000 0.000000
## x9 0.000000 0.000000</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a>  <span class="fu">t</span>(m<span class="sc">$</span>x)<span class="sc">%*%</span>A<span class="sc">%*%</span>(m<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>##              [,1]
## [1,] 1.797536e-17</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>  B <span class="ot">&lt;-</span> A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(m<span class="sc">$</span>x, m<span class="sc">$</span>y), <span class="dv">6</span>))</span></code></pre></div>
<pre><code>##        [,1]     [,2]
## x1 0.000000 0.000000
## x2 0.000000 0.000000
## x3 0.409836 0.409836
## x4 0.000000 0.000000
## x5 0.327869 0.327869
## x6 0.000000 0.000000
## x7 0.262295 0.262295
## x8 0.000000 0.000000
## x9 0.000000 0.000000</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>  <span class="fu">t</span>(m<span class="sc">$</span>x)<span class="sc">%*%</span>B<span class="sc">%*%</span>(m<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    2</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>A</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(C)</span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(n<span class="sc">$</span>x, n<span class="sc">$</span>y), <span class="dv">6</span>))</span></code></pre></div>
<pre><code>##        [,1]     [,2]
## x1 0.000000 0.000000
## x2 0.000000 0.000000
## x3 0.409836 0.409836
## x4 0.000000 0.000000
## x5 0.327869 0.327869
## x6 0.000000 0.000000
## x7 0.262295 0.262295
## x8 0.000000 0.000000
## x9 0.000000 0.000000</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a>  <span class="fu">t</span>(n<span class="sc">$</span>x)<span class="sc">%*%</span>C<span class="sc">%*%</span>(n<span class="sc">$</span>y)</span></code></pre></div>
<pre><code>##              [,1]
## [1,] 3.595072e-17</code></pre>
<p>We find that the optimal solutions obtained using the two payoff
matrices are the same, but there is a significant difference in the game
values for <span class="math inline">\(\mathrm{B} \leftarrow
\mathrm{A}+2, \mathrm{~B} \leftarrow 2 * \mathrm{~A}\)</span>, and <span class="math inline">\(A\)</span></p>
</div>
</div>
<div id="homework-9" class="section level2">
<h2>homework 9</h2>
<div id="homework-9.1" class="section level3">
<h3>homework 9.1</h3>
<p>Exercise 1: Why do you need to use unlist() to convert a list to an
atomic vector? Why doesn’t as.vector() work?</p>
<p>Exercise 2: What does dim() return when applied to a vector?</p>
<p>Exercise 3: If is.matrix(x) is TRUE, what will is.array(x)
return?</p>
<p>Exercise 4: What does as.matrix() do when applied to a data frame
with columns of different types?</p>
<p>Exercise 5: Can you have a data frame with 0 rows? What about 0
columns?</p>
</div>
<div id="answer-9.1" class="section level3">
<h3>answer 9.1</h3>
<p>Exercise 1:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a>  <span class="do">## 举例</span></span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb160-3"><a href="#cb160-3" tabindex="-1"></a>  A[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;stat&quot;</span>,<span class="st">&quot;2023&quot;</span>)</span>
<span id="cb160-4"><a href="#cb160-4" tabindex="-1"></a>  A[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="dv">24</span></span>
<span id="cb160-5"><a href="#cb160-5" tabindex="-1"></a>  A[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb160-6"><a href="#cb160-6" tabindex="-1"></a>  </span>
<span id="cb160-7"><a href="#cb160-7" tabindex="-1"></a>  <span class="fu">print</span>(A)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;stat&quot; &quot;2023&quot;
## 
## [[2]]
## [1] 24
## 
## [[3]]
## [[3]][[1]]
## [1] 3
## 
## [[3]][[2]]
## [1] 4</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a>  <span class="fu">unlist</span>(A)</span></code></pre></div>
<pre><code>## [1] &quot;stat&quot; &quot;2023&quot; &quot;24&quot;   &quot;3&quot;    &quot;4&quot;</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a>  <span class="fu">as.vector</span>(A)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;stat&quot; &quot;2023&quot;
## 
## [[2]]
## [1] 24
## 
## [[3]]
## [[3]][[1]]
## [1] 3
## 
## [[3]][[2]]
## [1] 4</code></pre>
<p>Thus, we cannot recombine the elements of the list into a vector
using as.vector().</p>
<p>Exercise 2:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">12</span>,<span class="dv">9</span>)</span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a>  <span class="fu">dim</span>(y)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>The return value is NULL.</p>
<p>Exercise 3:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb168-2"><a href="#cb168-2" tabindex="-1"></a>  <span class="fu">is.matrix</span>(X)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a>  <span class="fu">is.array</span>(X)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>If is.matrix(x) returns TRUE, is.array(x) will also return TRUE,
indicating that in R, a matrix is a special type of array.</p>
<p>Exercise 4:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;add&quot;</span>,<span class="st">&quot;baa&quot;</span>,<span class="st">&quot;caa&quot;</span>)</span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb172-3"><a href="#cb172-3" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,y)</span>
<span id="cb172-4"><a href="#cb172-4" tabindex="-1"></a>  data</span></code></pre></div>
<pre><code>##     x y
## 1 add 1
## 2 baa 2
## 3 caa 3</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>  <span class="fu">as.matrix</span>(data)</span></code></pre></div>
<pre><code>##      x     y  
## [1,] &quot;add&quot; &quot;1&quot;
## [2,] &quot;baa&quot; &quot;2&quot;
## [3,] &quot;caa&quot; &quot;3&quot;</code></pre>
<p>The as.matrix() function can normally transform a data frame to a
matrix.</p>
<p>Exercise 5:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a>  <span class="co"># 创建一个有0行但有2列的数据框</span></span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a>  dat1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(列1 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">0</span>), 列2 <span class="ot">=</span> <span class="fu">character</span>(<span class="dv">0</span>))</span>
<span id="cb176-3"><a href="#cb176-3" tabindex="-1"></a>  <span class="fu">dim</span>(dat1)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a>  <span class="co"># 创建一个有0列的数据框</span></span>
<span id="cb178-2"><a href="#cb178-2" tabindex="-1"></a>  dat2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb178-3"><a href="#cb178-3" tabindex="-1"></a>  <span class="fu">dim</span>(dat2)</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a>  <span class="co"># 这将创建一个既没有行也没有列的空数据框。</span></span></code></pre></div>
</div>
<div id="homework-9.2" class="section level3">
<h3>homework 9.2</h3>
<p>Exercise 1: The function below scales a vector so it falls in the
range [0,1]. How would you apply it to every column of a data frame? How
would you apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a>  scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a>    rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a>    (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a>  }</span></code></pre></div>
<p>Exercise 2: Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
</div>
<div id="answer-9.2" class="section level3">
<h3>answer 9.2</h3>
<p>Exercise 1:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a>  <span class="do">## 假设data是我们的数据框，我们将scale01函数应用于数据框的每一列</span></span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>),<span class="at">Y=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>))</span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a>  <span class="fu">sapply</span>(data, scale01)</span></code></pre></div>
<pre><code>##              X         Y
## [1,] 0.0000000 0.0000000
## [2,] 0.1111111 0.3333333
## [3,] 0.4444444 0.5000000
## [4,] 1.0000000 1.0000000</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a>  <span class="do">## 假设data1是我们的数据框，我们仅将scale01函数应用于数据框的数值列</span></span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>),<span class="at">Y=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>),<span class="at">Z=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;n&quot;</span>,<span class="st">&quot;aa&quot;</span>))</span>
<span id="cb184-3"><a href="#cb184-3" tabindex="-1"></a>  numcols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data2, is.numeric)</span>
<span id="cb184-4"><a href="#cb184-4" tabindex="-1"></a>  <span class="fu">sapply</span>(data2[,numcols], scale01)</span></code></pre></div>
<pre><code>##              X         Y
## [1,] 0.0000000 0.0000000
## [2,] 0.1111111 0.3333333
## [3,] 0.4444444 0.5000000
## [4,] 1.0000000 1.0000000</code></pre>
<p>Exercise 2:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a>  <span class="do">## 计算数值型数据框的每列的标准差</span></span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>),<span class="at">Y=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>))</span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a>  <span class="fu">vapply</span>(data, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        X        Y 
## 4.041452 2.500000</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a>  <span class="do">## 计算混合型数据框的每个数值列的标准差</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a>  data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>),<span class="at">Y=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">9</span>),<span class="at">Z=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;n&quot;</span>,<span class="st">&quot;aa&quot;</span>))</span>
<span id="cb188-3"><a href="#cb188-3" tabindex="-1"></a>  numcols <span class="ot">&lt;-</span> <span class="fu">vapply</span>(data2, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb188-4"><a href="#cb188-4" tabindex="-1"></a>  <span class="fu">vapply</span>(data2[numcols], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        X        Y 
## 4.041452 2.500000</code></pre>
</div>
<div id="homework-9.3" class="section level3">
<h3>homework 9.3</h3>
<p>Consider Exercise 9.8 (pages 278, Statistical Computing with R).
(Hint: Refer to the first example of Case studies section)</p>
<p>(1)Write an R function.</p>
<p>(2)Write an Rcpp function.</p>
<p>(3)Compare the computation time of the two functions with the
function “microbenchmark”.</p>
<p>Exercise 9.8 Consider the bivariate density <span class="math display">\[
f(x, y) \propto\left(\begin{array}{l}
n \\
x
\end{array}\right) y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1, \ldots, n, 0
\leq y \leq 1 .
\]</span></p>
<p>It can be shown that for fixed <span class="math inline">\(a, b,
n\)</span>, the conditional distributions are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span> and <span class="math inline">\(\operatorname{Beta}(x+a, n-x+b)\)</span>. Use the
Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer-9.3" class="section level3">
<h3>answer 9.3</h3>
<p>Write an R function and an Rcpp function to implement the Gibbs
sampler and use the microbenchmark package to compare the computation
time of these two implementations.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a>  gibbssampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, N) {</span>
<span id="cb190-2"><a href="#cb190-2" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb190-3"><a href="#cb190-3" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb190-4"><a href="#cb190-4" tabindex="-1"></a>    y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)  <span class="do">## 初始值</span></span>
<span id="cb190-5"><a href="#cb190-5" tabindex="-1"></a>    <span class="do">## 交替迭代</span></span>
<span id="cb190-6"><a href="#cb190-6" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb190-7"><a href="#cb190-7" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[i<span class="dv">-1</span>])</span>
<span id="cb190-8"><a href="#cb190-8" tabindex="-1"></a>      y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i]<span class="sc">+</span>a, n<span class="sc">-</span>x[i]<span class="sc">+</span>b)</span>
<span id="cb190-9"><a href="#cb190-9" tabindex="-1"></a>    }</span>
<span id="cb190-10"><a href="#cb190-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">data.frame</span>(x, y))</span>
<span id="cb190-11"><a href="#cb190-11" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a>  <span class="fu">cppFunction</span>(<span class="st">&#39;</span></span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a><span class="st">  DataFrame gibbssampler_Rcpp(int n, double a, double b, int N) {</span></span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a><span class="st">    NumericVector x(N);</span></span>
<span id="cb191-4"><a href="#cb191-4" tabindex="-1"></a><span class="st">    NumericVector y(N);</span></span>
<span id="cb191-5"><a href="#cb191-5" tabindex="-1"></a><span class="st">    y[0] = R::runif(0, 1);  // 初始值</span></span>
<span id="cb191-6"><a href="#cb191-6" tabindex="-1"></a><span class="st">    // 交替迭代</span></span>
<span id="cb191-7"><a href="#cb191-7" tabindex="-1"></a><span class="st">    for (int i = 1; i &lt; N; ++i) {</span></span>
<span id="cb191-8"><a href="#cb191-8" tabindex="-1"></a><span class="st">      x[i] = R::rbinom(n, y[i-1]);</span></span>
<span id="cb191-9"><a href="#cb191-9" tabindex="-1"></a><span class="st">      y[i] = R::rbeta(x[i]+a, n-x[i]+b);</span></span>
<span id="cb191-10"><a href="#cb191-10" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb191-11"><a href="#cb191-11" tabindex="-1"></a><span class="st">    return DataFrame::create(Named(&quot;x&quot;)=x, Named(&quot;y&quot;)=y);</span></span>
<span id="cb191-12"><a href="#cb191-12" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb191-13"><a href="#cb191-13" tabindex="-1"></a><span class="st">  &#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a>  <span class="do">## 使用microbenchmark包比较这两个函数的性能。</span></span>
<span id="cb192-2"><a href="#cb192-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb192-3"><a href="#cb192-3" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb192-4"><a href="#cb192-4" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb192-5"><a href="#cb192-5" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb192-6"><a href="#cb192-6" tabindex="-1"></a></span>
<span id="cb192-7"><a href="#cb192-7" tabindex="-1"></a>  benchmark <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb192-8"><a href="#cb192-8" tabindex="-1"></a>    <span class="at">R =</span> <span class="fu">gibbssampler</span>(n, a, b, N),</span>
<span id="cb192-9"><a href="#cb192-9" tabindex="-1"></a>    <span class="at">Rcpp =</span> <span class="fu">gibbssampler_Rcpp</span>(n, a, b, N),</span>
<span id="cb192-10"><a href="#cb192-10" tabindex="-1"></a>    <span class="at">times =</span> <span class="dv">30</span></span>
<span id="cb192-11"><a href="#cb192-11" tabindex="-1"></a>  )</span>
<span id="cb192-12"><a href="#cb192-12" tabindex="-1"></a>  <span class="fu">print</span>(benchmark)</span></code></pre></div>
<pre><code>## Unit: microseconds
##  expr    min     lq      mean  median     uq    max neval
##     R 2117.5 2234.6 2866.0600 2292.90 3552.8 7282.7    30
##  Rcpp  260.9  275.9  306.9167  282.25  291.4  934.8    30</code></pre>
<p>We compared the performance of the Gibbs sampler implemented in pure
R and Rcpp under the same conditions. Typically, the Rcpp version will
have better performance, especially in cases requiring a large number of
iterations. Here, the computational efficiency is compared based on the
average values, 2886/310 = 9.3, meaning the Rcpp version is about 10
times more efficient than R.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
